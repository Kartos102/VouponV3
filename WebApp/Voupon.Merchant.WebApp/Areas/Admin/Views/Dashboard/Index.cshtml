
@{
    ViewData["Title"] = "Dashboard";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<div class="dashboard-main-wrapper">
    <div class="dashboard-ecommerce">
        <div class="container-fluid dashboard-content admin-dashboard">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">Dashboard</h1>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                    <div class="section-block">
                        <h3 class="section-title">Merchants</h3>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12 dashboard-Products">
                    <div class="section-block">
                        <h3 class="section-title">Products</h3>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                    <div class="row">

                        <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12">
                            <div class="card">
                                <div class="card-body">
                                    <p>Totals</p>
                                    <h1 class="mb-1" id="merchantTotal">0</h1>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12">
                            <div class="card" style="background-color:#ffe699" onclick="window.location.href = '/Admin/Merchants';">
                                <div class="card-body">
                                    <p>Pending Review</p>
                                    <h1 class="mb-1" id="merchantPendingReview">0</h1>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12">
                            <div class="card">
                                <div class="card-body" style="background-color:#fbe5d6">
                                    <p>Pending Revision</p>
                                    <h1 class="mb-1" id="merchantPendingRevision">0</h1>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12">
                            <div class="card">
                                <div class="card-body" style="background-color:#e2f0d9">
                                    <p>Published</p>
                                    <h1 class="mb-1" id="merchantPublished">0</h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12">
                    <div class="row">
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-12 dashboard-Products-small">
                            <div class="section-block">
                                <h3 class="section-title">
                                    Products
                                </h3>
                            </div>
                        </div>

                        <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12">
                            <div class="card">
                                <div class="card-body">
                                    <p>Totals</p>
                                    <h1 class="mb-1" id="productTotal">0</h1>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12">
                            <div class="card">
                                <div class="card-body" style="background-color:#ffe699" onclick="window.location.href = '/Admin/Products';">
                                    <p>Pending Review</p>
                                    <h1 class="mb-1" id="productPendingReview">0</h1>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12">
                            <div class="card">
                                <div class="card-body" style="background-color:#fbe5d6">
                                    <p>Pending Revision</p>
                                    <h1 class="mb-1" id="productPendingRevision">0</h1>
                                </div>
                            </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12">
                            <div class="card">
                                <div class="card-body" style="background-color:#e2f0d9">
                                    <p>Published</p>
                                    <h1 class="mb-1" id="productPublished">0</h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12 Merchants-table">
                    <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12 pending-review-title-small">
                        <div class="section-block">
                            <h3 class="section-title">Pending Merchant Review</h3>
                        </div>
                    </div>
                    <div class="table-responsive-lg">
                        <table id="dtPendingReviewMerchants" class="table table-striped table-bordered">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col" style="text-align: center;">Merchant ID</th>
                                    <th scope="col" style="text-align: center;">Business Name</th>
                                    <th scope="col" style="text-align: center;">Created Date</th>
                                    <th scope="col" style="text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12 products-table">
                    <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12 pending-review-title-small">
                        <div class="section-block">
                            <h3 class="section-title">Pending Product Review</h3>
                        </div>
                    </div>
                    <div class="table-responsive-lg">
                        <table id="dtPendingReviewProducts" class="table table-striped table-bordered">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col" style="text-align: center;">Product ID</th>
                                    <th scope="col" style="text-align: center;">Product Name</th>
                                    <th scope="col" style="text-align: center;">Business Name</th>
                                    <th scope="col" style="text-align: center;">Created Date</th>
                                    <th scope="col" style="text-align: center;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div hidden class="row">
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                    <div class="card">
                        <div class="card-header">
                            <h3>Revenue</h3>
                            <p>Today</p>
                            <p>RM 10.00</p>
                        </div>
                        <div class="card-body">
                            <p>Yesterday</p>
                            <p>RM 200</p>
                        </div>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                    <div class="card">
                        <div class="card-header">
                            <h3>Products sold</h3>
                            <p>Today</p>
                            <p>1</p>
                        </div>
                        <div class="card-body">
                            <p>Yesterday</p>
                            <p>50</p>
                        </div>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                    <div class="card">
                        <div class="card-header">
                            <h3>My Products</h3>
                            <p>Active</p>
                            <p>3</p>
                        </div>
                        <div class="card-body">
                            <p>Inactive</p>
                            <p>5</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div style="display:none">
    <div class="row card-table-row card-merchant-tamplate">
        <div class="mobile-card-row row col-12 col-md-4 col-sm-12">
            <div class="image-container">
                <img class="image merchant-product-image" />
            </div>
            <a class="product-title-anchor col-12">
                <h3 class="card-title-name Merchant-id">
                    Test
                </h3>
            </a>
        </div>
        <div class="mobile-card-row row col-12 col-md-8 col-sm-12">
            <div class="row col-12">
                <div class="col-6 card-title-row">
                    Business Name:
                </div>
                <div class="col-6 card-record-row company-name">
                    1
                </div>
            </div>
            <div class="row col-12">
                <div class="col-6 card-title-row">
                    Created Date:
                </div>
                <div class="col-6 card-record-row created-date">
                    5.00
                </div>
            </div>
            <div class="row col-12">
                <div class="col-6 card-title-row">
                    Action:
                </div>
                <div class="col-6 card-record-row merchant-action">

                </div>
            </div>
        </div>
    </div>
</div>

<div style="display:none">
    <div class="row card-table-row card-product-tamplate">
        <div class="mobile-card-row row col-12 col-md-4 col-sm-12">
            <div class="image-container">
                <img class="image merchant-product-image" />
            </div>
            <a class="product-title-anchor col-12">
                <h3 class="card-title-name product-name">
                    Test
                </h3>
            </a>
        </div>
        <div class="mobile-card-row row col-12 col-md-8 col-sm-12">
            <div class="row col-12">
                <div class="col-6 card-title-row">
                    Prdocut ID:
                </div>
                <div class="col-6 card-record-row product-id">
                    1
                </div>
            </div>
            <div class="row col-12">
                <div class="col-6 card-title-row">
                    Business Name:
                </div>
                <div class="col-6 card-record-row company-name">
                    5.00
                </div>
            </div>
            <div class="row col-12">
                <div class="col-6 card-title-row">
                    Created Date:
                </div>
                <div class="col-6 card-record-row product-createdAt">

                </div>
            </div>
            <div class="row col-12">
                <div class="col-6 card-title-row">
                    Action:
                </div>
                <div class="col-6 card-record-row activated-toggle product-action">
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts{


    <script>

        $(document).ready(function () {
            $("#product-search-btn").on("click", function () {
                var execludedList = [];
                var value = $("#product-search-input").val().toLowerCase();
                if (value == "") {
                    $(".products-table-card").children().each(function () {
                        $(this).show();
                    })
                    return false;
                }
                $(".card-product-tamplate").find(".product-name").filter(function () {
                    var textToFilter = $(this).text() + " " + $(this).parent().parent().parent().find(".product-id").text() + " " + $(this).parent().parent().parent().find(".company-name").text();
                    if (textToFilter.toLowerCase().indexOf(value) == -1) {
                        $(this).parent().parent().parent().hide();
                    }
                    else {
                        $(this).parent().parent().parent().show();
                    }
                });
            });

            $("#product-search-input").on("search", function () {
                var execludedList = [];
                var value = $("#product-search-input").val().toLowerCase();
                if (value == "") {
                    $(".products-table-card").children().each(function () {
                        $(this).show();
                    })
                    return false;
                }
                $(".card-product-tamplate").find(".product-name").filter(function () {
                    var textToFilter = $(this).text() + " " + $(this).parent().parent().parent().find(".product-id").text() + " " + $(this).parent().parent().parent().find(".company-name").text();
                    if (textToFilter.toLowerCase().indexOf(value) == -1) {
                        $(this).parent().parent().parent().hide();
                    }
                    else {
                        $(this).parent().parent().parent().show();
                    }
                });
            });

            $("#merchant-search-btn").on("click", function () {
                var execludedList = [];
                var value = $("#merchant-search-input").val().toLowerCase();
                if (value == "") {
                    $(".merchant-table-card").children().each(function () {
                        $(this).show();
                    })
                    return false;
                }
                $(".card-merchant-tamplate").find(".Merchant-id").filter(function () {
                    var textToFilter = $(this).text() + " " + $(this).parent().parent().parent().find(".company-name").text() /*+ " " + $(this).siblings().eq(1).text()*/;
                    if (textToFilter.toLowerCase().indexOf(value) == -1) {
                        $(this).parent().parent().parent().hide();
                    }
                    else {
                        $(this).parent().parent().parent().show();
                    }
                });
            });

            $("#merchant-search-input").on("search", function () {
                var execludedList = [];
                var value = $("#merchant-search-input").val().toLowerCase();
                if (value == "") {
                    $(".merchant-table-card").children().each(function () {
                        $(this).show();
                    })
                    return false;
                }
                $(".card-merchant-tamplate").find(".Merchant-id").filter(function () {
                    var textToFilter = $(this).text() + " " + $(this).parent().parent().parent().find(".company-name").text() /*+ " " + $(this).siblings().eq(1).text()*/;
                    if (textToFilter.toLowerCase().indexOf(value) == -1) {
                        $(this).parent().parent().parent().hide();
                    }
                    else {
                        $(this).parent().parent().parent().show();
                    }
                });
            });

            GetDashboard();
            GetPendingReviewMerchants();
            GetPendingReviewProducts();
        });

        function GetPendingReviewMerchants() {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: true,
                url: '/Admin/Dashboard/GetPendingReviewMerchants',
                success: function (response) {
                    if (response.successful) {
                        if (response.data.length > 0) {
                            var i = 1;
                            $(response.data).each(function (index, item) {
                                var row = "<tr>";
                                row = row + "<td>" + item.code + "</td>";
                                row = row + "<td>" + item.displayName + "</td>";
                                row = row + "<td>" + moment(item.createdAt).format("YYYY-MM-DD") + "</td>";
                                row = row + "<td>" + "<a class=btn-review'' href='/Admin/Merchants/Details/" + item.id + "'>Review</a>" + "</td>";
                                row = row + "</tr>";
                                $("#dtPendingReviewMerchants").append(row);

                                i++;
                            });
                        }
                    }
                }
            });
        }


        function GetPendingReviewProducts() {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: true,
                url: '/Admin/Dashboard/GetPendingReviewProducts',
                success: function (response) {
                    if (response.successful) {
                        if (response.data.length > 0) {
                            var i = 1;

                            $(response.data).each(function (index, item) {
                                console.log(item);
                                var row = "<tr>";
                                row = row + "<td>" + item.id + "</td>";
                                row = row + "<td>" + item.title + "</td>";
                                row = row + "<td>" + item.merchantName + "</td>";
                                row = row + "<td>" + moment(item.createdAt).format("YYYY-MM-DD") + "</td>";
                                row = row + "<td>" + "<a class=btn-review'' href='/Admin/Products/Edit/" + item.id + "'>Review</a>" + "</td>";
                                row = row + "</tr>";
                                $("#dtPendingReviewProducts").append(row);

                                i++;
                            });
                        }
                    }
                }
            });
        }

        function GetDashboard() {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: true,
                url: '/Admin/Dashboard/GetDashboard',
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            $("#merchantTotal").html(response.data.merchantTotal);
                            $("#merchantDraft").html(response.data.merchantDraft);
                            $("#merchantApproved").html(response.data.merchantApproved);
                            $("#merchantPendingReview").html(response.data.merchantPendingReview);
                            $("#merchantPendingRevision").html(response.data.merchantPendingRevision);
                            $("#merchantPublished").html(response.data.merchantPublished);
                            $("#productTotal").html(response.data.productTotal);
                            $("#productDraft").html(response.data.productDraft);
                            $("#productApproved").html(response.data.productApproved);
                            $("#productPendingReview").html(response.data.productPendingReview);
                            $("#productPendingRevision").html(response.data.productPendingRevision);
                            $("#productPublished").html(response.data.productPublished);

                        }
                    }
                }
            });
        }
    </script>
}



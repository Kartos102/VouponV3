@model Voupon.Merchant.WebApp.Areas.Admin.ViewModels.Products.EditProductViewModel
@{ViewData["Title"] = "Edit Product";
                Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
    }
<link rel="stylesheet" href="~/admin/Products/css/Edit.css" />
<link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>

<div class="dashboard-main-wrapper">
    <div class="dashboard-ecommerce">
        <div class="container-fluid dashboard-content " style="display:none" id="allDiv">

            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header" id="productId" data-id="@Model.ProductId" image-url="">Edit Product</h1>
                </div>
            </div>

            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 mb-5 no-padding">
                    <div class="section-block">
                        <p></p>
                    </div>
                    <div class="tab-regular">
                        <ul class="nav nav-tabs nav-fill" id="myTab7" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active show" id="home-tab-justify" data-toggle="tab" href="#product-info" role="tab" aria-controls="home" aria-selected="true">Product Info</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="product-variation-tab-justify" data-toggle="tab" href="#product-variation-tab" role="tab" aria-controls="home" aria-selected="true">Product Variation</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="product-target-tab-justify" data-toggle="tab" href="#product-target-tab" role="tab" aria-controls="target" aria-selected="true">Target</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="profile-tab-justify" data-toggle="tab" href="#outlet-info" role="tab" aria-controls="profile" aria-selected="false">Outlet Info</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="contact-tab-justify" data-toggle="tab" href="#redemption-info" role="tab" aria-controls="contact" aria-selected="false">Delivery Info</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="discount-tab-justify" data-toggle="tab" href="#discount-info" role="tab" aria-controls="discount" aria-selected="false">Discount Info</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="luckydraw-tab-justify" data-toggle="tab" href="#luckydraw-info" role="tab" aria-controls="luckydraw" aria-selected="false">Lucky Draw Info</a>
                            </li>
                        </ul>
                        <div class="tab-content" id="myTabContent7">
                            <div class="tab-pane fade active show" id="product-info" role="tabpanel" aria-labelledby="home-tab-justify">
                                <div class="row">
                                    <div class="col-lg-12" style="margin-top:15px;">
                                        <div class="alert alert-secondary" role="alert" id="productStatusBadge">
                                            <h4 class="alert-heading" id="productStatus" data-id="0">Draft</h4>
                                            <hr>
                                            <p class="mb-0" id="productRemarks"></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        @*<span id="productStatus" data-id="0" class="badge badge-warning">Draft</span>*@
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <label class="col-form-label">Merchant Code</label>
                                        <input disabled id="EditMerchantCode" type="text" class="form-control" value="">
                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <label class="col-form-label">Merchant Name</label>
                                        <input disabled id="EditMerchantName" type="text" class="form-control" value="">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <label class="col-form-label">Deal Type</label>
                                        <select class="form-control" id="EditDealTypeList">
                                        </select>
                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <label class="col-form-label">Commission (%)</label>
                                        <input disabled id="EditCommission" type="text" class="form-control" value="">
                                    </div>
                                </div>

                                <div class="row product-info-key">
                                    <div class="col-xl-4 col-lg-5 col-md-6 col-sm-12 col-12 mt-0">
                                        <div class="col-12 form-group row ">
                                            <img style="display:none" id="imageFolderUrl" file-name="" />
                                            <div class="form-label">
                                                <span class="btn btn-primary btn-file">
                                                    Upload Product Images
                                                </span>
                                            </div>
                                            <input type="file" name="files[]" id="EditImage" class="form-control" value="" multiple>
                                        </div>
                                        <div class="row col-12 product-img-container">
                                            <div class="gallery mr-3" id="imageGallery"></div>
                                        </div>
                                        <div class="row col-12 mt-2">
                                            <i>Drag and drop images to rearrange ordering</i>
                                        </div>
                                    </div>
                                    <div class="col-xl-8 col-lg-7 col-md-6 col-sm-12 col-12 mt-0">
                                        <div class="form-group row">
                                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                <label class="col-form-label">Product Title</label>
                                                <input id="EditTitle" type="text" class="form-control" value="">
                                            </div>
                                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                <label for="contact" class="col-form-label">Subtitle</label>
                                                <input id="EditSubtitle" type="text" class="form-control" value="">
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                <label class="col-form-label">Product Category</label>
                                                <select class="form-control" id="EditCategoryList">
                                                </select>
                                            </div>
                                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                <label for="contact" class="col-form-label">Product Subcategory</label>
                                                <select class="form-control" id="EditSubcategoryList">
                                                </select>
                                            </div>
                                        </div>
                                        <div id="priceTypeDiv">
                                            <div class="form-group row">
                                                <div class="col-xl-3 col-lg-3 col-md-2 col-sm-12 col-12 product-quantity d-flex align-items-center">
                                                    <label class="col-form-label pr-2">Quantity:</label>
                                                    <input id="EditQuantity" type="number" class="form-control" min="0" value="0">
                                                </div>
                                                <div class="col-xl-9 col-lg-9 col-md-10 col-sm-12 col-12 row no-padding">
                                                    <div class="col-md-5 col-sm-12 col-12 d-flex align-items-center">
                                                        <label class="col-form-label">Original Price:</label>
                                                        <div class="d-flex align-items-center mt-md-1">
                                                            <span class="p-2">RM</span>
                                                            <input id="EditPrice" type="number" class="form-control" value="0">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-7 col-sm-12 col-12 d-flex align-items-center">
                                                        <div class="form-label">
                                                            <label for="contact" class="col-form-label">Discounted Price:</label>
                                                            <div class="switch-button ml-2">
                                                                <input type="checkbox" checked="" name="IsDiscountedPriceEnabled" id="IsDiscountedPriceEnabled">
                                                                <span>
                                                                    <label for="IsDiscountedPriceEnabled"></label>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="d-flex align-items-center mt-md-1 mt-3">
                                                            <span class="p-2">RM</span>
                                                            <input id="EditDiscountedPrice" type="number" class="form-control" value="0">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                    <label class="col-form-label">Third Party</label>
                                                    @Html.DropDownListFor(x => x.OutletModel.ThirdPartyTypeId, Model.OutletModel.ThirdPartyType, new { @class = "form-control" })
                                                </div>
                                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12" id="thirdpartyProductContainer">
                                                    <label class="col-form-label">Third party product</label>
                                                    @Html.DropDownListFor(x => x.OutletModel.ThirdPartyProductId, Model.OutletModel.ThirdPartyProducts, new { @class = "form-control" })
                                                </div>
                                            </div>
                                        </div>
                                        <div id="pointTypeDiv">
                                            <div class="form-group row">
                                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                    <label class="col-form-label">Product Price (RM)</label>
                                                    <input id="actualproductPrice" type="text" class="form-control" min="0" value="0">
                                                </div>
                                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                    <label class="col-form-label">Point Required</label>
                                                    <input id="EditPointRequired" type="number" class="form-control" min="0" value="0">
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                    <label class="col-form-label">Quantity</label>
                                                    <input id="EditQuantity" type="number" class="form-control" min="0" value="0">
                                                </div>
                                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                    <label class="col-form-label">Third Party</label>
                                                    @Html.DropDownListFor(x => x.OutletModel.ThirdPartyTypeId, Model.OutletModel.ThirdPartyType, new { @class = "form-control" })
                                                </div>
                                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12" id="thirdpartyProductContainer">
                                                    <label class="col-form-label">Third party product</label>
                                                    @Html.DropDownListFor(x => x.OutletModel.ThirdPartyProductId, Model.OutletModel.ThirdPartyProducts, new { @class = "form-control" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                <label for="selectBankType" class="col-form-label">Start Date</label>
                                                <input class="form-control" type="date" value="2011-08-19" id="EditStartDate">

                                            </div>
                                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                                <label for="selectBankType" class="col-form-label">End Date</label>
                                                <input class="form-control" type="date" value="2011-08-19" id="EditEndDate">
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 col-12">
                                                <label for="contact" class="col-form-label">Shipping cost </label>
                                                <br />
                                                <label for="contact" class="col-form-label preview-shipping-type">Free shipping </label>
                                                <a href="#" class="btn btn-secondary ml-3" id="btnShippingCostModal">Edit</a>
                                            </div>
                                            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 col-12 tool-tip-container">
                                                <div>
                                                    <label for="contact" class="col-form-label"> Share shipping cost <i>for the same item</i><a href="#" class="tool-tip-selector ml-3" title="" ><i class="fa fa-question-circle-o" aria-hidden="true"></i></a> </label>
                                                </div>
                                                <div>
                                                     <div class="row d-flex align-items-center">
                                                            <span class="col-form-label col-lg-8 col-xl-8 col-md-8">If order quality is less than</span>
                                                            <div class="col-lg-4 col-xl-4 col-md-4 p-0">
                                                                <input class=" form-control" type="number" id="shareShippingCostSameItem" value="0">
                                                            </div>
                                                        </div>
                                                </div> 
                                            </div>
                                            <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12 col-12 tool-tip-container">
                                                <div>
                                                    <label for="contact" class="col-form-label">Share shipping cost <i>for the different items</i><a href="#" class="tool-tip-selector2 ml-3" title="" ><i class="fa fa-question-circle-o" aria-hidden="true"></i></a> </label>
                                                </div>
                                                
                                                 <div class="switch-button ml-2">
                                                     <input type="checkbox" name="isShareShippingDifferentItem" id="isShareShippingDifferentItem">
                                                        <span>
                                                            <label for="isShareShippingDifferentItem"></label>
                                                        </span>
                                                 </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
                                            <label class="col-form-label">Description</label>
                                            <input type="hidden" id="EditDescription" />
                                            <div id="edit-description">
                                            </div>
                                        </div>
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <label for="contact" class="col-form-label">Addition Info</label>
                                            <input type="hidden" id="EditAdditionInfo" />
                                            <div id="edit-addition-Info">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <label class="col-form-label">Fine Print <i>(Warranty, T&C, Return/refund information)</i></label>
                                            <input type="hidden" id="EditFinePrint" />
                                            <div id="edit-fine-print">
                                            </div>
                                        </div>
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <label for="contact" class="col-form-label">Delivery Info</label>
                                            <input type="hidden" id="EditRedemptionInfo" />
                                            <div id="edit-redemption-info">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group row save-div">
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <a href="#" class="btn btn-primary" id="btnUpdateProduct">Update</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="product-variation-tab" role="tabpanel" aria-labelledby="home-tab-justify">
                                <div class="row mb-3">
                                    <div class="align-center pl-2">
                                        <h4 style="margin:0;">
                                            Enable Product Variations
                                        </h4>
                                    </div>
                                    <div class="pl-2 align-center">
                                        <div class="switch-button">
                                            <input type="checkbox" checked="" name="isProductVariationEnabled" id="isProductVariationEnabled"><span>
                                                <label for="isProductVariationEnabled"></label>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="row variation-parent-div">
                                    <div class="row">
                                        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-3 col-12">
                                            <h4>Variation 1</h4>
                                        </div>
                                        <span class="close-Variation-icon first-variation-close hide">
                                            <i class="fa fa-times"></i>
                                        </span>
                                        <div class="col-xl-10 col-lg-10 col-md-9 col-sm-9 col-12">

                                            <section class="card card-fluid variation-card variation1-card">
                                                <div class="variation-Name-field">
                                                    <div class="mr-3 variation-Name-label">Name</div>
                                                    <div class="variation-input-div">
                                                        <div class="input-group variation-name-input-div">
                                                            <input type="text" class="form-control variation-name-input" maxlength="14" placeholder="Enter Variation Name, eg: colour, etc.">
                                                            <div class="input-group-append"><span class="input-group-text character-counter">0/14</span></div>
                                                        </div>
                                                        <div class="variation-input-container">
                                                            <div class="btn-group hide">
                                                                <i class="fa fa-sort btn variationOptionsSort"></i>
                                                                <button class="btn btn-sm btn-outline-light">
                                                                    <i class="fa fa-trash"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <ul class="sortable-lists list-group list-group-flush list-group-bordered" id="items">
                                                    <li class="list-group-item align-items-center" draggable="false">
                                                        <div class="mr-3 variation-Name-label">Options</div>
                                                        <div class="variation-input-div">
                                                            <div class="input-group variation-option-input-div">
                                                                <input type="text" class="form-control variation-option-input" maxlength="20" placeholder="Enter Variation Options, eg: Red, etc.">
                                                                <div class="input-group-append"><span class="input-group-text character-counter">0/20</span></div>
                                                            </div>
                                                            <div class="variation-input-container">
                                                                <div class="btn-group">
                                                                    <i class="fa fa-sort btn variationOptionsSort"></i>
                                                                    <button class="btn btn-sm btn-outline-light variation-option-delete-btn" style="display:none">
                                                                        <i class="fa fa-trash"></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>
                                                <div class="variation-option-add-div">
                                                    <button class="btn btn-block variation-option-add-btn" variation-number="1"> <i class="fa fa-plus-circle"></i><span class="variation-option-add-btn-text">  Add Options (2/20)</span></button>
                                                </div>
                                            </section>
                                        </div>
                                    </div>
                                    <div class="row mt-5">
                                        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-3 col-12">
                                            <h4>Variation 2</h4>
                                        </div>
                                        <div class="col-xl-10 col-lg-10 col-md-9 col-sm-9 col-12">
                                            <button class="btn btn-block variation2-add-btn"> <i class="fa fa-plus-circle"></i><span class="variation-option-add-btn-text">  Add</span></button>
                                        </div>
                                        <div class="col-xl-10 col-lg-10 col-md-9 col-sm-9 col-12 variation2-section" style="display:none">

                                            <section class="card card-fluid variation-card">
                                                <span class="close-Variation-icon second-variation-close">
                                                    <i class="fa fa-times"></i>
                                                </span>
                                                <div class="variation-Name-field">
                                                    <div class="mr-3 variation-Name-label">Name</div>
                                                    <div class="variation-input-div">
                                                        <div class="input-group variation-name-input-div">
                                                            <input type="text" class="form-control variation-name-input" maxlength="14" placeholder="Enter Variation Name, eg: colour, etc.">
                                                            <div class="input-group-append"><span class="input-group-text character-counter">0/14</span></div>
                                                        </div>
                                                        <div class="variation-input-container">
                                                            <div class="btn-group hide">
                                                                <i class="fa fa-sort btn variationOptionsSort"></i>
                                                                <button class="btn btn-sm btn-outline-light">
                                                                    <i class="fa fa-trash"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <ul class="sortable-lists list-group list-group-flush list-group-bordered" id="items">
                                                    <li class="list-group-item align-items-center" draggable="false">
                                                        <div class="mr-3 variation-Name-label">Options</div>
                                                        <div class="variation-input-div">
                                                            <div class="input-group variation-option-input-div">
                                                                <input type="text" class="form-control variation-option-input" maxlength="20" placeholder="Enter Variation Options, eg: Red, etc.">
                                                                <div class="input-group-append"><span class="input-group-text character-counter">0/20</span></div>
                                                            </div>
                                                            <div class="variation-input-container">
                                                                <div class="btn-group">
                                                                    <i class="fa fa-sort btn variationOptionsSort"></i>
                                                                    <button class="btn btn-sm btn-outline-light variation-option-delete-btn" style="display:none">
                                                                        <i class="fa fa-trash"></i>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>
                                                <div class="variation-option-add-div">
                                                    <button class="btn btn-block variation-option-add-btn"> <i class="fa fa-plus-circle"></i><span class="variation-option-add-btn-text">  Add Options (2/20)</span></button>
                                                </div>
                                            </section>
                                        </div>
                                    </div>
                                    <div class="row mt-5">
                                        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-3 col-12">
                                            <h4>
                                                Variation Information
                                            </h4>
                                        </div>
                                        <div class="col-xl-10 col-lg-10 col-md-9 col-sm-9 col-12 variation-applyall-info-div">
                                            <div class="col-12 col-sm-6 col-md-6 col-lg-6 col-xl-6 variation-applyall-container row">
                                                <div class="input-group variation-price-applyall-input-div col-5">
                                                    <div class="input-group-append"><span class="input-group-text character-counter">RM</span></div>
                                                    <input type="number" class="form-control variation-price-applyall-input" placeholder="Price" min="0">
                                                </div>
                                                <div class="col-2">
                                                    <div class="switch-button">
                                                        <input type="checkbox" name="isDiscountedPriceEnabledApplyAll" id="isDiscountedPriceEnabledApplyAll" class="variation-discounted-price-applyall-checkbox">
                                                        <span>
                                                            <label for="isDiscountedPriceEnabledApplyAll"></label>
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="input-group variation-discounted-price-applyall-input-div col-5">
                                                    <div class="input-group-append"><span class="input-group-text character-counter">RM</span></div>
                                                    <input type="number" class="form-control variation-discounted-price-applyall-input" placeholder="Discounted Price" disabled min="0">
                                                </div>
                                            </div>
                                            <div class="col-12 col-sm-6 col-md-6 col-lg-6 col-xl-6 variation-applyall-container row">
                                                <div class="col-4">
                                                    <input type="number" class="form-control variation-stock-applyall-input" placeholder="Stock" min="0">
                                                </div>
                                                <div class="col-4">
                                                    <input type="text" class="form-control variation-sku-applyall-input" placeholder="SKU">
                                                </div>
                                                <div class="col-4">
                                                    <button type="button" class="btn btn-primary" id="btnVariationApplyToAll">Apply To All</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mt-5">
                                        <div class="col-xl-2 col-lg-2 col-md-12 col-sm-12 col-12">
                                            <span>
                                                Variation List
                                            </span>
                                        </div>
                                        <div class="col-xl-10 col-lg-10 col-md-9 col-sm-9 col-9 variation-table">
                                            <div class="table-row table-headers">
                                                <div class="variation-table-cell table-header">
                                                    Name
                                                </div>
                                                <div class="variation-table-cell table-header" style="display:none">
                                                    Name
                                                </div>
                                                <div class="variation-table-cell table-header">
                                                    Price
                                                </div>
                                                <div class="variation-table-cell table-header">
                                                    Discounted Price enabled
                                                </div>
                                                <div class="variation-table-cell table-header">
                                                    Discounted Price
                                                </div>
                                                <div class="variation-table-cell table-header">
                                                    Stock
                                                </div>
                                                <div class="variation-table-cell table-header">
                                                    SKU
                                                </div>
                                            </div>
                                            <div class="table-row">
                                                <div class="variation-table-cell">
                                                    Option
                                                </div>
                                                <div class="variation2-group">
                                                    <div class="flex product-variation-details-row">
                                                        <div class="variation-table-cell" style="display:none">
                                                            Option
                                                        </div>
                                                        <div class="variation-table-cell input-cell">
                                                            <div class="input-group variation-price-input-div">
                                                                <div class="input-group-append"><span class="input-group-text character-counter">RM</span></div>
                                                                <input type="number" class="form-control variation-price-input" placeholder="Input" min="0">
                                                            </div>
                                                        </div>
                                                        <div class="variation-table-cell input-cell">
                                                            <div class="switch-button">
                                                                <input type="checkbox" name="isDiscountedPriceEnabled" id="isDiscountedPriceEnabled" class="variation-discounted-price-checkbox"><span>
                                                                    <label for="isDiscountedPriceEnabled"></label>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="variation-table-cell input-cell">
                                                            <div class="input-group variation-discounted-price-input-div">
                                                                <div class="input-group-append"><span class="input-group-text character-counter">RM</span></div>
                                                                <input type="number" class="form-control variation-discounted-price-input" placeholder="Input" disabled min="0">
                                                            </div>
                                                        </div>
                                                        <div class="variation-table-cell input-cell">
                                                            <input type="number" class="form-control variation-stock-input" value="0" min="0">
                                                        </div>
                                                        <div class="variation-table-cell input-cell">
                                                            <input type="text" class="form-control variation-sku-input">

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="row mt-5">

                                        <div class="col-xl-2 col-lg-2 col-md-12 col-sm-12 col-12">
                                            <img id="variationImageFolderUrl" file-name="" />
                                            <label class="col-form-label image-variation-label">Variation 1</label>
                                        </div>
                                        <div class="col-xl-10 col-lg-10 col-md-9 col-sm-9 col-9">

                                            <div class="form-group row">
                                                <span class="btn btn-primary btn-variation-file">
                                                    <span class="variation-images-text"></span>
                                                    <i class="fa fa-upload"></i>
                                                </span>
                                            </div>
                                            <div class="variation-gallery" id="variationimageGallery"></div>
                                            <input type="file" name="files[]" id="EditVariationImage" class="form-control" value="" multiple>
                                        </div>
                                    </div>

                                </div>
                                <div class="form-group row save-div">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <a href="#" class="btn btn-primary" id="btnUpdateVariation">Update</a>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="product-target-tab" role="tabpanel" aria-labelledby="target-tab-justify">
                                <div class="form-group row">
                                    <div class="align-center pl-2">
                                        <h3 class="mb-2">
                                            Demographic target
                                        </h3>
                                    </div>
                                </div>
                                <div class="form-group row" id="demo-target-container">
                                </div>
                                <div class="form-group row save-div">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <a href="#" class="btn btn-primary" id="btnUpdateDemographicTargets">Save</a>
                                        <button type="button" class="btn btn-secondary btnReview" style="margin-left: 10px;">Message Admin</button>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="outlet-info" role="tabpanel" aria-labelledby="profile-tab-justify">
                                <div class="form-group row save-div">
                                    <div class="col-12">
                                        <a href="#" class="btn btn-primary" id="btnAddOutletModal" style="float:right;">Add New Outlet</a>
                                    </div>
                                </div>
                                <form style="max-width: 1200px;">
                                    <div class="row">
                                        <div class="col-md-6 col-sm-12 col-12">
                                            <label for="selectBankType" class="col-form-label">Outlet List</label>
                                        </div>
                                        <div class="col-md-6 col-sm-12 col-12 row p-0">
                                            <div class="col-md-1 d-md-flex d-none">
                                            </div>
                                            <div class="col-md-11 col-sm-12 col-12">
                                                <label for="selectBankType" class="col-form-label">Supported Outlet</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <select id='EditOutletList' multiple='multiple'>
                                        </select>
                                    </div>

                                    <div class="form-group row save-div">
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <a href="#" class="btn btn-primary" id="btnUpdateOutlet">Update</a>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="tab-pane fade" id="redemption-info" role="tabpanel" aria-labelledby="contact-tab-justify">

                                <div class="form-group row">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <label for="selectBankType" class="col-form-label">Product Type</label>
                                        <select class="form-control" id="EditDealExpirationList">
                                        </select>
                                    </div>
                                </div>
                                <div style="display:none" id="redemptionDigital">
                                    <div class="form-group row">
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <label class="col-form-label">Redemption Token Types</label>
                                            <select class="form-control" id="EditDigitalRedemptionOption">
                                                <option value="1">Manually - Provide token manually</option>
                                                @*<option value="2">API URL - Generate token automatically</option>*@
                                            </select>
                                        </div>
                                        <div style="display:none" class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12" id="redemptionDigitalURL">
                                            <label class="col-form-label">API URL</label>
                                            <input id="EditDigitalRedemptionURL" type="text" class="form-control" placeholder="Enter API URL">
                                        </div>
                                    </div>
                                </div>
                                <div style="display:none" id="redemptionDays">
                                    <div class="form-group row">
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <label for="selectBankType" class="col-form-label">Total Valid Days</label>
                                            <input id="EditRedemptionDays" type="number" class="form-control" min="0" value="0">
                                        </div>
                                    </div>
                                </div>
                                <div style="display:none" id="redemptionDate">
                                    <div class="form-group row">
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <label class="col-form-label">Redemption Start Date</label>
                                            <input class="form-control" type="date" value="2011-08-19" id="EditRedemptionStartDate">

                                        </div>
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <label class="col-form-label">Redemption End Date</label>
                                            <input class="form-control" type="date" value="2011-08-19" id="EditRedemptionEndtDate">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group row save-div">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <a href="#" class="btn btn-primary" id="btnUpdateRedemption">Update</a>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="discount-info" role="tabpanel" aria-labelledby="discount-tab-justify">

                                <form style="max-width: 1200px;">
                                    <div class="form-group row">
                                        <div class="col-md-6 col-sm-12 col-12">
                                            <label class="col-form-label">Available Discounts</label>
                                        </div>
                                        <div class="col-md-6 col-sm-12 col-12 row p-0">
                                            <div class="col-md-1 d-md-flex d-none">
                                            </div>
                                            <div class="col-md-11 col-sm-12 col-12">
                                                <label class="col-form-label">Activated Discounts</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <select id='EditValidDiscountList' multiple='multiple'>
                                        </select>
                                    </div>

                                    <div class="form-group row save-div">
                                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                            <a href="#" class="btn btn-primary" id="btnEditDiscount">Edit Discount</a>
                                            <a href="#" class="btn btn-primary" id="btnAddDiscount">Add Discount</a>
                                            <a href="#" class="btn btn-primary" id="btnUpdateDiscount">Update</a>
                                        </div>
                                    </div>
                                </form>
                            </div>

                            <div class="tab-pane fade" id="luckydraw-info" role="tabpanel" aria-labelledby="luckydraw-tab-justify">
                                <div class="form-group row">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <label class="col-form-label">Total Issuesed Ticket</label>
                                        <input id="EditLuckyDrawTicketIssuesed" type="text" disabled class="form-control" value="0">
                                    </div>

                                </div>

                                <div class="form-group row">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <label class="col-form-label">Lucky Draw Date</label>
                                        <input id="EditLuckyDrawDate" type="date" class="form-control" value="">

                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <label class="col-form-label">Lucky Draw Winning Ticket</label>
                                        <input id="EditWinningTicketId" type="text" disabled class="form-control" value="0">
                                    </div>
                                </div>

                                <div class="form-group row save-div">
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <a href="#" class="btn btn-primary" id="btnUpdateLuckyDrawDate">Update Lucky Draw Date</a>
                                    </div>
                                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                        <a href="#" class="btn btn-primary" id="btnUpdateWinningTicket">Update Winning Ticket</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Review Business Info Modal -->
<div id="tooltip1" style="display:none">
    <div class="justify-content-start p-2">
        <span><b>For example :</b></span>
    <p>if this 5 and customer purchased 8 of the same items, we will charge 2x shipping cost to the buyer for this item.</p>
    </div>
</div>

<div id="tooltip2" style="display:none">
    <div class="justify-content-start p-2">
        <span><b>For example :</b></span>
    <p>if a customer has purchased three different items from your shop that have this toggled On, we will only charge the customer the highest shipping fee among these three items once.</p>
    </div>
</div>

<div class="modal fade" id="ReviewProduct" status-id="0" remarks="" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Review Product</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group row">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                        <label class="col-form-label">Deal Type</label>
                        <input id="reviewDealType" type="text" class="form-control" readonly value="">
                    </div>
                </div>
                <div class="row">
                    <div class="col-xl-4 col-lg-5 col-md-6 col-sm-12 col-12 mt-0 px-0">
                        <div class="col-12 gallery" id="reviewImageGallery"></div>
                    </div>
                    <div class="col-xl-8 col-lg-7 col-md-6 col-sm-12 col-12 mt-0 px-0">
                        <div class="form-group row">
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label class="col-form-label">Title</label>
                                <input id="reviewTitle" type="text" class="form-control" readonly value="">
                            </div>
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label for="contact" class="col-form-label">Subtitle</label>
                                <input id="reviewSubtitle" type="text" class="form-control" readonly value="">
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label class="col-form-label">Product Category</label>
                                <input id="reviewCategory" type="text" class="form-control" readonly value="">
                            </div>
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label for="contact" class="col-form-label">Product Subcategory</label>
                                <input id="reviewSubcategory" type="text" class="form-control" readonly value="">
                            </div>
                        </div>
                        <div id="reviewPriceTypeDiv">
                            <div class="form-group row">
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                    <label class="col-form-label">Original Price</label>
                                    <input id="reviewPrice" type="text" class="form-control" value="0" readonly>
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                    <div class="form-label">
                                        <label for="contact" class="col-form-label">Discounted Price (Merchant) </label>
                                        <div class="switch-button ml-2">
                                            <input type="checkbox" checked="" name="reviewIsDiscountedPriceEnabled" id="reviewIsDiscountedPriceEnabled"><span>
                                                <label for="reviewIsDiscountedPriceEnabled"></label>
                                            </span>
                                        </div>
                                    </div>
                                    <input id="reviewDiscountedPrice" type="text" class="form-control" value="0" readonly>
                                </div>
                            </div>
                        </div>
                        <div id="reviewPointTypeDiv">
                            <div class="form-group row">
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                    <label class="col-form-label">Product Price (RM)</label>
                                    <input id="reviewActualproductPrice" type="text" class="form-control" min="0" value="0" readonly>
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                    <label class="col-form-label">Point Required</label>
                                    <input id="reviewPointRequired" type="number" class="form-control" min="0" value="0" readonly>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                    <label class="col-form-label">Quantity</label>
                                    <input id="reviewQuantity" type="number" class="form-control" min="0" value="0" readonly>
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                    <label class="col-form-label">Third Party</label>
                                    @Html.DropDownListFor(x => x.OutletModel.ReviewThirdPartyTypeId, Model.OutletModel.ThirdPartyType, new { @class = "form-control" })
                                </div>
                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12" id="reviewThirdpartyProductContainer">
                                    <label class="col-form-label">Third party product</label>
                                    @Html.DropDownListFor(x => x.OutletModel.ReviewThirdPartyProductId, Model.OutletModel.ThirdPartyProducts, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-lg-3 col-md-4 col-sm-12 col-12">
                                <label for="contact" class="col-form-label">Shipping cost </label>
                                <br />
                                <label for="contact" class="col-form-label preview-shipping-type">Free shipping </label>
                                <a href="#" class="btn btn-secondary ml-3" id="btnShippingCostModal">Edit</a>
                            </div>
                            <div class="row col-12 col-md-8 col-lg-9">
                                <div class="col-lg-6 col-sm-12 col-12 mb-2 tool-tip-container">
                                    <div class="mb-1">
                                        <label for="contact" class="col-form-label"> Share shipping cost <i>for multi-quantity order</i> </label>
                                    </div>
                                    <div>
                                        <div class="row d-flex align-items-center">
                                            <span class="col-form-label col-lg-8 col-xl-8 col-md-8">If order quality is less than</span>
                                            <div class="col-lg-4 col-xl-4 col-md-4 p-0">
                                                <input class=" form-control" type="number" id="reviewShareShippingCostSameItem" value="0" readonly>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-sm-12 col-12 mb-2 tool-tip-container">
                                    <div class="mb-1">
                                        <label for="contact" class="col-form-label">Share shipping cost <i>with other items sold in my shop</i></label>
                                    </div>

                                    <div class="switch-button ml-2">
                                        <input type="checkbox" name="reviewShareShippingDifferentItem" id="reviewShareShippingDifferentItem" disabled="disabled">
                                        <span>
                                            <label for="reviewShareShippingDifferentItem"></label>
                                        </span>
                                    </div>
                                </div>
                            </div>    
                        </div>
                        <div class="form-group row">
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label for="selectBankType" class="col-form-label">Start Date</label>
                                <input class="form-control" type="date" value="2011-08-19" id="reviewStartDate" readonly>

                            </div>
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label for="selectBankType" class="col-form-label">End Date</label>
                                <input class="form-control" type="date" value="2011-08-19" id="reviewEndDate" readonly>
                            </div>
                        </div>
                    </div>                <div class="form-group row">
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label class="col-form-label">Description</label>
                            <input type="hidden" id="reviewDescription" />
                            <div id="review-description">
                            </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label for="contact" class="col-form-label">Addition Info</label>
                            <input type="hidden" id="reviewAdditionInfo" />
                            <div id="review-addition-Info">
                            </div>
                        </div>
                    </div>
                    <div class="form-group row">
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label class="col-form-label">Fine Print <i>(Warranty, T&C, Return/refund information)</i></label>
                            <input type="hidden" id="reviewFinePrint" />
                            <div id="review-fine-print">
                            </div>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label for="contact" class="col-form-label">Redemption Info</label>
                            <input type="hidden" id="reviewRedemptionInfo" />
                            <div id="review-redemption-info">
                            </div>
                        </div>
                    </div>
                </div>
                <form>
                    <div class="form-group">
                        <label for="message-text" class="col-form-label">Review Remarks:</label>
                        <div class="form-control" contenteditable="true" id="productReviewRemarks" readonly></div>
                    </div>
                    <div class="form-group">
                        <label for="recipient-name" class="col-form-label">Status:</label>
                        <select class="form-control" id="productStatusList">
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="message-text" class="col-form-label">Message:</label>
                        <textarea class="form-control" id="productStatusRemarks"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="UpdateProductStatus">Update</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="EditDiscount" data-id="0" remarks="" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Discount</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="form-group row" id="divCreatedDiscountList">
                    <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                        <label for="selectCreatedDiscount" class="col-form-label">Created Discount List</label>
                        <select class="form-control" id="selectCreatedDiscount">
                        </select>
                    </div>
                </div>

                <div id="divEditDiscount">
                    <div class="form-group row">
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label for="selectDiscountType" class="col-form-label">Discount Type</label>
                            <select class="form-control" id="selectDiscountType">
                            </select>
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label class="col-form-label">Product Price<span id="productPrice"></span></label>
                            <input id="EditProductPriceOrPoints" class="form-control" disabled>
                        </div>
                    </div>
                    <div>
                        <div class="form-group row">
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label class="col-form-label">Discount Value <span id="discountUnit"></span></label>
                                <input id="EditDiscountValue" type="number" class="form-control" min="0" value="0">
                            </div>
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label id="RequiredDiscountedValue" class="col-form-label">Point Required</label>
                                <input id="EditDiscountPoint" type="number" class="form-control" min="0" value="0">
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="form-group row hide">
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label class="col-form-label">Discount Start Date</label>
                                <input class="form-control" type="date" value="2011-08-19" id="EditDiscountStartDate">
                            </div>
                            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                                <label class="col-form-label">Discount End Date</label>
                                <input class="form-control" type="date" value="2011-08-19" id="EditDiscountEndDate">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="UpdateDiscount" status-id="edit">Update</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="WinningTicketModal" data-id="0" remarks="" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Update Lucky Draw Winning Ticket</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group row">
                    <div class="col-12">
                        <label class="col-form-label">Winning Ticket Id</label>
                        <input id="EditUpdateWinningTicketId" type="number" class="form-control" value="">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="UpdateWinningTicket" status-id="edit">Update</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="AddOutletModal" merchant-id="" role="dialog">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="modalTitle">Create New Outlet</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>

            </div>
            <div class="modal-body">
                <form id="createOutletForm" name="createOutletForm">
                    @Html.AntiForgeryToken()
                    <div class="form-group row">
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label asp-for="@Model.OutletModel.Name" class="col-form-label">Outlet Name</label>
                            <input asp-for="@Model.OutletModel.Name" id="outletName" class="form-control" />
                            <span asp-validation-for="@Model.OutletModel.Name" class="text-danger"></span><br />
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label asp-for="@Model.OutletModel.StreetName" class="col-form-label"></label>
                            <input id="streetName" asp-for="@Model.OutletModel.StreetName" class="form-control" />
                            <span asp-validation-for="@Model.OutletModel.StreetName" class="text-danger"></span><br />
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">

                            <label asp-for="@Model.OutletModel.CountryId" class="col-form-label"></label>
                            <select asp-for="@Model.OutletModel.CountryId" class="form-control selectpicker" id="countrySelect">
                                <option value="">Choose Country</option>
                            </select>
                            <span asp-validation-for="@Model.OutletModel.CountryId" class="text-danger"></span><br />
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label asp-for="@Model.OutletModel.ProvinceId" class="col-form-label"></label>
                            <select asp-for="@Model.OutletModel.ProvinceId" class="form-control selectpicker" id="provinceSelect" data-live-search="true">
                                <option value="">Choose Province</option>
                            </select>
                            <span asp-validation-for="@Model.OutletModel.ProvinceId" class="text-danger"></span><br />
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">

                            <label asp-for="@Model.OutletModel.DistrictId" class="col-form-label"></label>
                            <select asp-for="@Model.OutletModel.DistrictId" class="form-control selectpicker" id="distritSelect" data-live-search="true">
                                <option value="">Choose District</option>
                            </select>
                            <span asp-validation-for="@Model.OutletModel.DistrictId" class="text-danger"></span><br />
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label asp-for="@Model.OutletModel.PostCodeId" class="col-form-label"></label>
                            <select asp-for="@Model.OutletModel.PostCodeId" class="form-control selectpicker" id="postCodeSelect" data-live-search="true">
                                <option value="">Choose Postcode</option>
                            </select>
                            <span asp-validation-for="@Model.OutletModel.PostCodeId" class="text-danger"></span><br />
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label asp-for="@Model.OutletModel.Address_1" class="col-form-label"></label>
                            <input id="address1" asp-for="@Model.OutletModel.Address_1" class="form-control" />
                            <span asp-validation-for="@Model.OutletModel.Address_1" class="text-danger"></span><br />
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                            <label asp-for="@Model.OutletModel.Address_2" class="col-form-label"></label>
                            <input id="address2" asp-for="@Model.OutletModel.Address_2" class="form-control" />
                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">

                            <label asp-for="@Model.OutletModel.Contact" class="col-form-label"></label>
                            <input id="outletContact" asp-for="@Model.OutletModel.Contact" class="form-control" />
                            <span asp-validation-for="@Model.OutletModel.Contact" class="text-danger"></span><br />


                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
                        </div>
                        <div class="col-12">
                            <div>
                                <img id="imageFolderUrl" />
                                <label class="col-form-label">Upload your Outlet Photo</label>
                                <br />
                                <span class="btn btn-primary btn-outlet-file">
                                    Upload your Images
                                    <i class="fa fa-upload"></i>
                                </span>
                            </div>
                            <input type="file" name="files[]" multiple id="EditOutletImage" class="form-control" value="">
                        </div>
                        <div class="col-12 gallery" id="outletImageGallery"></div>

                    </div>
                    <div class="container-fluid py-2 mx-auto no-padding">
                        <div class="row d-flex justify-content-center">
                            <div class="col-md-12 col-lg-12 col-xl-12 no-padding">
                                <div class="card-working-hours border-0">
                                    <div class="row opening-hours-header">
                                        <div class="col-xl-5 col-4 row opening-hours-title-col">
                                            <h3 class="title-col mb-0 opening-hours">Opening Hours</h3>
                                        </div>
                                        <div class="col-xl-7 col-8 row grey-bg no-padding">
                                            <div class="col-4">
                                                <span>
                                                    Start
                                                </span>
                                            </div>
                                            <div class="col-4">
                                                <span>
                                                    End
                                                </span>
                                            </div>
                                            <div class="col-4">
                                                <input id="checkbox_hours_0" data-id="0" type="checkbox" name="closed" value="closed" class="closed" data-toggle="toggle" data-width="100" data-on="All Close" data-onstyle="danger" data-offstyle="success" data-off="All Open">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row col-12 list no-padding" id="Edit_Days_7">
                                        <div class="row col-12 opening-hours-row">
                                            <div class="col-xl-5 col-4 row opening-hours-title-col">
                                                <div class="col-5">
                                                    <span class="open-day">
                                                        Sun
                                                    </span>
                                                </div>
                                                <div class="col-7">
                                                    <span class="btn btn-primary btn_apply_all">Apply to All</span>
                                                </div>
                                            </div>
                                            <div class="col-xl-7 col-8 row no-padding">
                                                <div class="col-4 time-select">
                                                    <input id="start_hours_7" class="timepicker timepicker-with-dropdown from-time" name="from">
                                                </div>
                                                <div class="col-4 time-select">
                                                    <input id="end_hours_7" class="timepicker timepicker-with-dropdown end-time" name="to">
                                                </div>
                                                <div class="col-4">
                                                    <input id="checkbox_hours_7" data-id="7" type="checkbox" name="closed" value="closed" class="closed" data-toggle="toggle" data-width="100" data-on="Close" data-onstyle="danger" data-offstyle="success" data-off="Open">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row col-12 list no-padding" id="Edit_Days_1">
                                        <div class="row col-12 opening-hours-row">
                                            <div class="col-xl-5 col-4  row opening-hours-title-col">
                                                <div class="col-5">
                                                    <span class="open-day">
                                                        Mon
                                                    </span>
                                                </div>
                                                <div class="col-7">
                                                    <span class="btn btn-primary btn_apply_all">Apply to All</span>
                                                </div>
                                            </div>
                                            <div class="col-xl-7 col-8 grey-bg row no-padding">
                                                <div class="col-4 time-select">
                                                    <input id="start_hours_1" class="timepicker timepicker-with-dropdown from-time" name="from">
                                                </div>
                                                <div class="col-4 time-select">
                                                    <input id="end_hours_1" class="timepicker timepicker-with-dropdown end-time" name="to">
                                                </div>
                                                <div class="col-4">
                                                    <input id="checkbox_hours_1" data-id="1" type="checkbox" name="closed" value="closed" class="closed" data-toggle="toggle" data-width="100" data-on="Close" data-onstyle="danger" data-offstyle="success" data-off="Open">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row col-12 list no-padding" id="Edit_Days_2">
                                        <div class="row col-12 opening-hours-row">
                                            <div class="col-xl-5 col-4  row opening-hours-title-col">
                                                <div class="col-5">
                                                    <span class="open-day">
                                                        Tue
                                                    </span>
                                                </div>
                                                <div class="col-7">
                                                    <span class="btn btn-primary btn_apply_all">Apply to All</span>
                                                </div>
                                            </div>
                                            <div class="col-xl-7 col-8  row no-padding">
                                                <div class="col-4 time-select">
                                                    <input id="start_hours_2" class="timepicker timepicker-with-dropdown from-time" name="from">
                                                </div>
                                                <div class="col-4 time-select">
                                                    <input id="end_hours_2" class="timepicker timepicker-with-dropdown end-time" name="to">
                                                </div>
                                                <div class="col-4">
                                                    <input id="checkbox_hours_2" data-id="2" type="checkbox" name="closed" value="closed" class="closed" data-toggle="toggle" data-width="100" data-on="Close" data-onstyle="danger" data-offstyle="success" data-off="Open">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row col-12 list no-padding" id="Edit_Days_3">
                                        <div class="row col-12 opening-hours-row">
                                            <div class="col-xl-5 col-4  row opening-hours-title-col">
                                                <div class="col-5">
                                                    <span class="open-day">
                                                        Wed
                                                    </span>
                                                </div>
                                                <div class="col-7">
                                                    <span class="btn btn-primary btn_apply_all">Apply to All</span>
                                                </div>
                                            </div>
                                            <div class="col-xl-7 col-8 grey-bg  row no-padding">
                                                <div class="col-4 time-select">
                                                    <input id="start_hours_3" class="timepicker timepicker-with-dropdown from-time" name="from">
                                                </div>
                                                <div class="col-4 time-select">
                                                    <input id="end_hours_3" class="timepicker timepicker-with-dropdown end-time" name="to">
                                                </div>
                                                <div class="col-4">
                                                    <input id="checkbox_hours_3" data-id="3" type="checkbox" name="closed" value="closed" class="closed" data-toggle="toggle" data-width="100" data-on="Close" data-onstyle="danger" data-offstyle="success" data-off="Open">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row col-12 list no-padding" id="Edit_Days_4">
                                        <div class="row col-12 opening-hours-row">
                                            <div class="col-xl-5 col-4  row opening-hours-title-col">
                                                <div class="col-5">
                                                    <span class="open-day">
                                                        Thu
                                                    </span>
                                                </div>
                                                <div class="col-7">
                                                    <span class="btn btn-primary btn_apply_all">Apply to All</span>
                                                </div>
                                            </div>
                                            <div class="col-xl-7 col-8  row no-padding">
                                                <div class="col-4 time-select">
                                                    <input id="start_hours_4" class="timepicker timepicker-with-dropdown from-time" name="from">
                                                </div>
                                                <div class="col-4 time-select">
                                                    <input id="end_hours_4" class="timepicker timepicker-with-dropdown end-time" name="to">
                                                </div>
                                                <div class="col-4">
                                                    <input id="checkbox_hours_4" data-id="4" type="checkbox" name="closed" value="closed" class="closed" data-toggle="toggle" data-width="100" data-on="Close" data-onstyle="danger" data-offstyle="success" data-off="Open">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row col-12 list no-padding" id="Edit_Days_5">
                                        <div class="row col-12 opening-hours-row">
                                            <div class="col-xl-5 col-4  row opening-hours-title-col">
                                                <div class="col-5">
                                                    <span class="open-day">
                                                        Fri
                                                    </span>
                                                </div>
                                                <div class="col-7">
                                                    <span class="btn btn-primary btn_apply_all">Apply to All</span>
                                                </div>
                                            </div>
                                            <div class="col-xl-7 col-8 grey-bg  row no-padding">
                                                <div class="col-4 time-select">
                                                    <input id="start_hours_5" class="timepicker timepicker-with-dropdown from-time" name="from">
                                                </div>
                                                <div class="col-4 time-select">
                                                    <input id="end_hours_5" class="timepicker timepicker-with-dropdown end-time" name="to">
                                                </div>
                                                <div class="col-4">
                                                    <input id="checkbox_hours_5" data-id="5" type="checkbox" name="closed" value="closed" class="closed" data-toggle="toggle" data-width="100" data-on="Close" data-onstyle="danger" data-offstyle="success" data-off="Open">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row col-12 list no-padding" id="Edit_Days_6">
                                        <div class="row col-12 opening-hours-row">
                                            <div class="col-xl-5 col-4  row opening-hours-title-col">
                                                <div class="col-5">
                                                    <span class="open-day">
                                                        Sat
                                                    </span>
                                                </div>
                                                <div class="col-7">
                                                    <span class="btn btn-primary btn_apply_all">Apply to All</span>
                                                </div>
                                            </div>
                                            <div class="col-xl-7 col-8  row no-padding">
                                                <div class="col-4 time-select">
                                                    <input id="start_hours_6" class="timepicker timepicker-with-dropdown from-time" name="from">
                                                </div>
                                                <div class="col-4 time-select">
                                                    <input id="end_hours_6" class="timepicker timepicker-with-dropdown end-time" name="to">
                                                </div>                                                <div class="col-4">
                                                    <input id="checkbox_hours_6" data-id="6" type="checkbox" name="closed" value="closed" class="closed" data-toggle="toggle" data-width="100" data-on="Close" data-onstyle="danger" data-offstyle="success" data-off="Open">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row col-12 list no-padding" id="Edit_Days_8">
                                        <div class="row col-12 opening-hours-row">
                                            <div class="col-xl-5 col-4  row opening-hours-title-col">
                                                <div class="col-5">
                                                    <span class="open-day">
                                                        PH
                                                    </span>
                                                </div>
                                                <div class="col-7">
                                                    <span class="btn btn-primary btn_apply_all">Apply to All</span>
                                                </div>
                                            </div>
                                            <div class="col-xl-7 col-8 grey-bg row no-padding">
                                                <div class="col-4 time-select">
                                                    <input id="start_hours_8" class="timepicker from-time" name="from">
                                                </div>
                                                <div class="col-4 time-select">
                                                    <input id="end_hours_8" class="timepicker end-time" name="to">
                                                </div>
                                                <div class="col-4">
                                                    <input id="checkbox_hours_8" data-id="8" type="checkbox" name="closed" value="closed" class="closed" data-toggle="toggle" data-width="100" data-on="Close" data-onstyle="danger" data-offstyle="success" data-off="Open">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row  mt-3 justify-content-center">
                                        <button id="btnAddOutlet" class="btn btn-primary">Add</button>
                                        <button id="btnUpdateOutlet" style="display:none;" class="btn btn-primary">Update</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="EditShippingCostModal" data-id="0" remarks="" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Shipping Cost</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="form-group row">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                        <div style="display:flex">
                            <label for="" class="col-form-label mr-3">Type</label>
                            <select class="form-control selectpicker" id="ShippingCostType">
                            </select>
                        </div>
                    </div>
                </div>
                <div class="form-group row conditional-shipping-type">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                        <div class="row align-center mt-2">
                            <label for="" class="col-form-label col">
                                Minimum order value required for shoppers to get free shipping.
                            </label>
                            <div class="shipping-price-div">
                                <label for="" class="col-form-label">RM</label>
                                <input class="form-control ml-3 shipping-condi-cost-input" value="0.00" min="0.00" type="number">
                            </div>
                        </div>
                    </div>
                </div>
                <div id="divProvincesShippingCost">
                    <hr />
                    <h5 style="font-weight: bold;">Shipping cost</h5>
                    <div class="form-group row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                            <div class="mb-2">
                                <label for="" class="col-form-label mr-3">Fast input</label>
                                <div class="shipping-price-div">
                                    <div class="col row">
                                        <label for="shippingCostApplyAll" class="col-form-label">RM</label>
                                        <input class="form-control ml-3 mr-3" id="shippingCostApplyAll" value="0.00" min="0" type="number" />
                                    </div>
                                    <a href="#" class="btn btn-secondary" id="btnShippingCostApplyAll">Apply to all</a>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="updateShippingDetails" status-id="edit">Save</button>
            </div>
        </div>
    </div>
</div>


<li class="list-group-item align-items-center variation-option-template" draggable="false" style="display:none">
    <div class="mr-3 variation-Name-label">Options</div>
    <div class="variation-input-div">
        <div class="input-group variation-option-input-div">
            <input type="text" class="form-control variation-option-input" maxlength="20" placeholder="Enter Variation Options, eg: Red, etc.">
            <div class="input-group-append"><span class="input-group-text character-counter">0/20</span></div>
        </div>
        <div class="variation-input-container">
            <div class="btn-group">
                <i class="fa fa-sort btn variationOptionsSort"></i>
                <button class="btn btn-sm btn-outline-light variation-option-delete-btn">
                    <i class="fa fa-trash"></i>
                </button>
            </div>
        </div>
    </div>
</li>



@section styles{

    <link rel="stylesheet" href="~/app/Products/css/ProductVariations.css" />

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">
    <!-- Theme included stylesheets -->
    <link href="//cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <link href="//cdn.quilljs.com/1.3.6/quill.bubble.css" rel="stylesheet">
    <!-- Core build with no theme, formatting, non-essential modules -->
    <link href="//cdn.quilljs.com/1.3.6/quill.core.css" rel="stylesheet">

}

@section scripts{
    <script src="~/lib/FilesValidations.js?v=2"></script>

    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>-->
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.2/jquery.ui.touch-punch.min.js"></script>
    <script>
        var outletfilesList = [];
        var filesList = [];
        var removefilesList = [];
        var variationImagesList = [];
        var removeVariationImagesList = [];
        var unattachedVariationImagesIndexes = [];

        var rinngitToPoints = @Model.OutletModel.RinggitPerVpoints;
        function SetRemoveImageEvent() {
            $(".remove-img").unbind().click(function () {
                var index = $(this).parent(".product-img-preview-container").attr("index");
                $(this).parent(".product-img-preview-container").remove();
                filesList.splice(index, 1);

                var index = 0;
                $("#imageGallery").find(".product-img-preview-container").each(function () {
                    $(this).attr("index", index++);
                });
            });
        }

        function SetRemoveOutletImageEvent() {
            $(".remove-outlet-img").unbind().click(function () {
                var index = $(this).parent(".outlet-img-preview-container").attr("index");
                $(this).parent(".outlet-img-preview-container").remove();
                outletfilesList.splice(index, 1);

                var index = 0;
                $("#outletImageGallery").find(".outlet-img-preview-container").each(function () {
                    $(this).attr("index", index++);
                });
            });
        }

        function SetRemoveImageUrlEvent() {
            $(".remove-img-url").unbind().click(function () {
                var imagesrc = $(this).parent(".product-img-preview-container").attr("image-src");
                $(this).parent(".product-img-preview-container").remove();
                var index = $(this).parent(".product-img-preview-container").attr("index");
                filesList.splice(index, 1);
                removefilesList.push(imagesrc);

                var index = 0;
                $(".gallery").find(".product-img-preview-container").each(function () {
                    $(this).attr("index", index++);
                });
            });
        }

        var imagesPreview = function (input, placeToInsertImagePreview) {
            if (input.files) {
                console.log(input.files);
                var filesAmount = input.files.length;
                for (i = 0; i < filesAmount; i++) {
                    var reader = new FileReader();
                    var imageNumber = 0;
                    reader.onload = function (event) {
                        $($.parseHTML('<div class="product-img-preview-container" index="' + imageNumber++ + '"><img src="' + event.target.result + '" class="product-img-preview"/><span class="remove-img">Remove image</span></div>')).appendTo(placeToInsertImagePreview);
                        SetRemoveImageEvent();
                    }
                    filesList.push(input.files[i]);
                    reader.readAsDataURL(input.files[i]);
                }
            }
        };

        var imagesOutletPreview = function (input, placeToInsertImagePreview) {
            if (input.files) {
                var filesAmount = input.files.length;
                for (i = 0; i < filesAmount; i++) {
                    var reader = new FileReader();
                    var imageNumber = 0;
                    reader.onload = function (event) {
                        $($.parseHTML('<div class="outlet-img-preview-container" index="' + imageNumber++ + '"><img src="' + event.target.result + '" class="outlet-img-preview"/><span class="remove-outlet-img">Remove image</span></div>')).appendTo(placeToInsertImagePreview);
                        SetRemoveOutletImageEvent();
                    }
                    outletfilesList.push(input.files[i]);
                    reader.readAsDataURL(input.files[i]);
                }
            }
        };

        $(document).ready(function () {
              $(".tool-tip-selector").tooltip({
            position: {
                my: "left-40 bottom-12", // the "anchor point" in the tooltip element
                at: "left top", // the position of that anchor point relative to selected element
            },
             track:true,
                content: function() {
                
                    return $('#tooltip1').html();
                }
            } );

            $(".tool-tip-selector2").tooltip({
            position: {
                my: "left-40 bottom-12", // the "anchor point" in the tooltip element
                at: "left top", // the position of that anchor point relative to selected element
            },
             track:true,
                content: function() {
                
                    return $('#tooltip2').html();
                }
            } );

            $('input.timepicker.from-time').timepicker({
                timeFormat: 'hh:mm p',
            });
            $('input.timepicker.end-time').timepicker({
                timeFormat: 'hh:mm p',
            });

            if ($("#OutletModel_ThirdPartyTypeId").val() == "") {
                $("#thirdpartyProductContainer").hide();
            }
            else {
                $("#thirdpartyProductContainer").show();
            }

            if ($("#OutletModel_ReviewThirdPartyTypeId").val() == "") {
                $("#reviewThirdpartyProductContainer").hide();
            }
            else {
                $("#reviewThirdpartyProductContainer").show();
            }

            $("#IsDiscountedPriceEnabled").change(function () {
                if ($(this).prop("checked") == true) {
                    $("#EditDiscountedPrice").prop("disabled", false);
                }
                else {
                    $("#EditDiscountedPrice").prop("disabled", true);
                }
            });

            $("#EditPrice").change(function () {
                if ($("#IsDiscountedPriceEnabled").prop("checked") == false) {
                    $("#EditDiscountedPrice").val($("#EditPrice").val());
                }

            });


            $("#outletImageGallery").sortable({
                start: function (event, ui) {
                    var start_pos = ui.item.index();
                    ui.item.data('start_pos', start_pos);
                },
                change: function (event, ui) {
                },
                update: function (event, ui) {

                    var start_pos = ui.item.data('start_pos');
                    var index = ui.item.index();
                    var temp = outletfilesList[start_pos];
                    //var temp1 = filesList[index];
                    outletfilesList.splice(start_pos, 1);
                    outletfilesList.splice(index, 0, temp);

                    var index = 0;
                    $(".outlet-img-preview-container").each(function () {
                        $(this).attr("index", index);
                        index++;
                    });

                }
            });

            $("#imageGallery").sortable({
                start: function (event, ui) {
                    var start_pos = ui.item.index();
                    ui.item.data('start_pos', start_pos);
                },
                change: function (event, ui) {
                    //  var start_pos = ui.item.data('start_pos');
                    // var index = ui.placeholder.index();
                    //  alert(start_pos);
                    //          alert(index);
                },
                update: function (event, ui) {

                    var start_pos = ui.item.data('start_pos');
                    var index = ui.item.index();
                    var temp = filesList[start_pos];
                    //var temp1 = filesList[index];
                    filesList.splice(start_pos, 1);
                    filesList.splice(index, 0, temp);

                    var index = 0;
                    $(".product-img-preview-container").each(function () {
                        $(this).attr("index", index);
                        index++;
                    });

                }
            });

            $("#actualproductPrice").on('change keyup paste', function (e) {
                var price = $("#actualproductPrice").val();
                $("#EditPointRequired").val(Math.round(price / rinngitToPoints));
            });

            $("#OutletModel_ReviewThirdPartyTypeId").change(function () {
                if ($(this).val() == "") {
                    $("#reviewThirdpartyProductContainer").hide();
                }
                else {
                    $("#reviewThirdpartyProductContainer").show();
                }
            });


            $("#OutletModel_ThirdPartyTypeId").change(function () {
                if ($(this).val() == "") {
                    $("#thirdpartyProductContainer").hide();
                }
                else {
                    $("#thirdpartyProductContainer").show();
                }
            });


            $('#distritSelect').change(function () {
                GetPostcodeList($(this).val());
                $("#postCodeSelect").selectpicker("refresh");
            });
            $('#provinceSelect').change(function () {

                GetDistrictList($(this).val());
                $("#distritSelect").val($("#distritSelect option:first").val());
                $('#distritSelect').change();
            });
            $('#countrySelect').change(function () {
                GetProvinceList($(this).val());
                $("#provinceSelect").val($("#provinceSelect option:first").val());
                $('#provinceSelect').change();
            });

            $("#btnAddOutletModal").click(function () {
                outletfilesList = [];
                $("#modalTitle").html("Create New Outlet");
                $("#btnAddOutlet").show();
                $("#createNewOutletModal").removeAttr("data-id");
                $("#outletName").val("");
                $("#streetName").val("");

                GetCountryList();
                $("#countrySelect").prop("selectedIndex", 0).selectpicker("refresh");

                //$("#countrySelect").val(0);
                GetProvinceList(0);
                $("#provinceSelect").selectpicker("refresh");
                GetDistrictList(0);
                $("#distritSelect").selectpicker("refresh");
                GetPostcodeList(0);
                $("#postCodeSelect").selectpicker("refresh");

                $("#address1").val("");
                $("#address2").val("");
                $("#outletContact").val("");
                $("#checkbox_hours_1").prop("checked", false);
                $("#checkbox_hours_2").prop("checked", false);
                $("#checkbox_hours_3").prop("checked", false);
                $("#checkbox_hours_4").prop("checked", false);
                $("#checkbox_hours_5").prop("checked", false);
                $("#checkbox_hours_6").prop("checked", false);
                $("#checkbox_hours_7").prop("checked", false);
                $("#checkbox_hours_8").prop("checked", false);
                $('.from-time').val("10:00 AM");
                $('.end-time').val("10:00 PM");
                $("#outletImageGallery").html("");
                $("#AddOutletModal").modal("show");
            });

            $("#btnAddOutlet").click(function (e) {
                e.preventDefault();
                if ($("#createOutletForm").valid()) {
                    var merchantId = $("#AddOutletModal").attr("merchant-id");
                    var name = $("#outletName").val();
                    var streetname = $("#streetName").val();
                    var countryId = $("#countrySelect").val();
                    var districtId = $("#distritSelect").val();
                    var provinceId = $("#provinceSelect").val();
                    var postcodeId = $("#postCodeSelect").val();
                    var address1 = $("#address1").val();
                    var address2 = $("#address2").val();

                    var contact = $("#outletContact").val();
                    var openinghours_1 = "";
                    var openinghours_2 = "";
                    var openinghours_3 = "";
                    var openinghours_4 = "";
                    var openinghours_5 = "";
                    var openinghours_6 = "";
                    var openinghours_7 = "";
                    var openinghours_8 = "";
                    if ($("#checkbox_hours_6").prop("checked") != true) {
                        var start_6 = $("#start_hours_6").val();
                        if (start_6 == "") {
                            $("#start_hours_6").focus();
                            return;
                        }
                        var end_6 = $("#end_hours_6").val();
                        if (end_6 == "") {
                            $("#end_hours_6").focus();
                            return;
                        }
                        openinghours_6 = start_6 + " - " + end_6;
                    }

                    if ($("#checkbox_hours_7").prop("checked") != true) {
                        var start_7 = $("#start_hours_7").val();
                        if (start_7 == "") {
                            $("#start_hours_7").focus();
                            return;
                        }
                        var end_7 = $("#end_hours_7").val();
                        if (end_7 == "") {
                            $("#end_hours_7").focus();
                            return;
                        }
                        openinghours_7 = start_7 + " - " + end_7;
                    }

                    if ($("#checkbox_hours_1").prop("checked") != true) {
                        var start_1 = $("#start_hours_1").val();
                        if (start_1 == "") {
                            $("#start_hours_1").focus();
                            return;
                        }
                        var end_1 = $("#end_hours_1").val();
                        if (end_1 == "") {
                            $("#end_hours_1").focus();
                            return;
                        }
                        openinghours_1 = start_1 + " - " + end_1;
                    }

                    if ($("#checkbox_hours_2").prop("checked") != true) {
                        var start_2 = $("#start_hours_2").val();
                        if (start_2 == "") {
                            $("#start_hours_2").focus();
                            return;
                        }
                        var end_2 = $("#end_hours_2").val();
                        if (end_2 == "") {
                            $("#end_hours_2").focus();
                            return;
                        }
                        openinghours_2 = start_2 + " - " + end_2;
                    }

                    if ($("#checkbox_hours_3").prop("checked") != true) {
                        var start_3 = $("#start_hours_3").val();
                        if (start_3 == "") {
                            $("#start_hours_3").focus();
                            return;
                        }
                        var end_3 = $("#end_hours_3").val();
                        if (end_3 == "") {
                            $("#end_hours_3").focus();
                            return;
                        }
                        openinghours_3 = start_3 + " - " + end_3;
                    }

                    if ($("#checkbox_hours_4").prop("checked") != true) {
                        var start_4 = $("#start_hours_4").val();
                        if (start_4 == "") {
                            $("#start_hours_4").focus();
                            return;
                        }
                        var end_4 = $("#end_hours_4").val();
                        if (end_4 == "") {
                            $("#end_hours_4").focus();
                            return;
                        }
                        openinghours_4 = start_4 + " - " + end_4;
                    }
                    if ($("#checkbox_hours_5").prop("checked") != true) {
                        var start_5 = $("#start_hours_5").val();
                        if (start_5 == "") {
                            $("#start_hours_5").focus();
                            return;
                        }
                        var end_5 = $("#end_hours_5").val();
                        if (end_5 == "") {
                            $("#end_hours_5").focus();
                            return;
                        }
                        openinghours_5 = start_5 + " - " + end_5;
                    }
                    if ($("#checkbox_hours_8").prop("checked") != true) {
                        var start_8 = $("#start_hours_8").val();
                        if (start_8 == "") {
                            $("#start_hours_8").focus();
                            return;
                        }
                        var end_8 = $("#end_hours_8").val();
                        if (end_8 == "") {
                            $("#end_hours_8").focus();
                            return;
                        }
                        openinghours_8 = start_8 + " - " + end_8;
                    }

                    $.ajax({
                        type: "POST",
                        dataType: 'json',
                        async: false,
                        data: {
                            MerchantId: merchantId, Name: name, StreetName: streetname, Address_1: address1,
                            Address_2: address2, CountryId: countryId, ProvinceId: provinceId, DistrictId: districtId, PostCodeId: postcodeId,
                            Contact: contact, ImgUrl: "", OpeningHour_1: openinghours_1, OpeningHour_2: openinghours_2,
                            OpeningHour_3: openinghours_3, OpeningHour_4: openinghours_4, OpeningHour_5: openinghours_5,
                            OpeningHour_6: openinghours_6, OpeningHour_7: openinghours_7, OpeningHour_8: openinghours_8
                        },
                        url: '/Admin/Products/CreateOutlet',
                        success: function (response) {
                            if (response.successful) {
                                toastr.success(response.message);
                                var outletId = response.data;
                                var imagefilesname = "";//$("#imageFolderUrl").attr("src");
                                // Read selected files
                                var imagefiles = document.getElementById("EditOutletImage").files[0];
                                if (imagefiles != null) {
                                    var formData = new FormData();
                                    var totalfiles = outletfilesList.length;
                                    for (var index = 0; index < totalfiles; index++) {

                                        formData.append("files[]", outletfilesList[index]);

                                    }
                                    $.ajax({
                                        url: "/Admin/Products/UploadOutletImages/" + outletId,
                                        type: "POST",
                                        async: false,
                                        data: formData,
                                        enctype: 'multipart/form-data',
                                        processData: false,
                                        contentType: false
                                    }).done(function (response) {
                                        if (response.successful) {
                                            imagefilesname = response.data;
                                            toastr.success(response.message);
                                        }
                                        else
                                            toastr.error(response.message);
                                    });


                                    $.ajax({
                                        type: "POST",
                                        dataType: 'json',
                                        async: false,
                                        data: {
                                            Id: outletId, Name: name, StreetName: streetname, Address_1: address1,
                                            Address_2: address2, CountryId: countryId, ProvinceId: provinceId, DistrictId: districtId, PostCodeId: postcodeId,
                                            Contact: contact, ImgUrl: imagefilesname, OpeningHour_1: openinghours_1, OpeningHour_2: openinghours_2,
                                            OpeningHour_3: openinghours_3, OpeningHour_4: openinghours_4, OpeningHour_5: openinghours_5,
                                            OpeningHour_6: openinghours_6, OpeningHour_7: openinghours_7, OpeningHour_8: openinghours_8
                                        },
                                        url: '/Admin/Products/UpdateOutlet',
                                        success: function (response) {
                                            if (response.successful) {
                                                var productId = $('#productId').attr("data-id");
                                                GetMerchantOutletList(merchantId);
                                                GetProductOutlets(productId);
                                                $('#EditOutletList').multiSelect({ selectableOptgroup: true });
                                                $('#EditOutletList').multiSelect('refresh');
                                                $("#AddOutletModal").modal("hide");
                                                toastr.success(response.message);
                                            }
                                            else
                                                toastr.error(response.message);
                                        },
                                        error: function (error) {
                                            toastr.error(error);
                                        }
                                    });
                                }

                            }
                            else
                                toastr.error(response.message);
                        },
                        error: function (error) {
                            toastr.error(error);
                        }
                    });
                }
            });

            $('.closed').change(function () {
                if ($(this).filter(':checked').val() == "closed") {
                    if ($(this).attr("data-id") == "0") {
                        var i;
                        for (i = 1; i <= 8; i++) {
                            $("#checkbox_hours_" + i).prop("checked", true);
                            $("#checkbox_hours_" + i).change();
                        }
                    }
                    else {
                        $("#Edit_Days_" + $(this).attr("data-id")).css("pointer-events", "none");
                        $("#Edit_Days_" + $(this).attr("data-id")).css("opacity", ".5");
                    }
                    //$(this).siblings(1).eq(1).find('input').each(function () {
                    //    $(this).attr('disabled', true).addClass("disabled-day");
                    //});
                } else {
                    if ($(this).attr("data-id") == "0") {
                        var i;
                        for (i = 1; i <= 8; i++) {
                            $("#checkbox_hours_" + i).prop("checked", false);
                            $("#checkbox_hours_" + i).change();
                        }
                    }
                    else {
                        $("#checkbox_hours_0").prop("checked", false);
                        $("#Edit_Days_" + $(this).attr("data-id")).css("pointer-events", "auto");
                        $("#Edit_Days_" + $(this).attr("data-id")).css("opacity", "1");
                    }
                    //$(this).siblings(1).eq(1).find('input').each(function () {
                    //    $(this).attr('disabled', false).removeClass("disabled-day");
                    //});
                }
            });

            $("#selectCreatedDiscount").change(function () {
                if ($(this).val() != 0) {
                    $("#divEditDiscount").show();
                    GetProductDiscount($(this).val());
                }
                else {
                    $("#divEditDiscount").hide();
                }
            });


            $("#btnUpdateDiscount").click(function () {
                var productId = $('#productId').attr("data-id");
                var selected = $('#EditValidDiscountList').val();
                $.ajax({
                    type: "POST",
                    dataType: 'json',
                    data: {
                        ProductId: productId, ProductDiscountId: selected
                    },
                    url: '/Admin/Products/UpdateProductDiscountsStatus',
                    success: function (response) {
                        if (response.successful)
                            toastr.success(response.message);
                        else
                            toastr.error(response.message);
                    },
                    error: function (error) {
                        toastr.error(error);
                    }
                });
            });
            $("#UpdateDiscount").click(function () {
                var productId = $('#productId').attr("data-id");
                var action = $('#UpdateDiscount').attr("status-id");
                var name = "";
                var priceValue = 0.00;
                var percentageValue = 0.00;
                var pointRequired = 0;
                if (action == "add") {
                    var discountTypeId = $('#selectDiscountType').val();
                    if (discountTypeId == 1) {
                        percentageValue = $('#EditDiscountValue').val();
                        pointRequired = $('#EditDiscountPoint').val();
                        name = percentageValue + "% DISCOUNT (" + pointRequired + " VPoints)";
                    }
                    else if (discountTypeId == 2) {
                        priceValue = $('#EditDiscountValue').val();
                        pointRequired = $('#EditDiscountPoint').val();
                        name = "RM" + priceValue + " DISCOUNT (" + pointRequired + " VPoints)";
                    }
                    else {
                        priceValue = $('#EditDiscountValue').val();
                        pointRequired = $('#EditDiscountPoint').val();
                        name = "RM" + priceValue + " DISCOUNT (" + pointRequired + " VPoints)";
                    }


                    var startDate = $('#EditDiscountStartDate').val();
                    var endDate = $('#EditDiscountEndDate').val();

                    $.ajax({
                        type: "POST",
                        dataType: 'json',
                        data: {
                            ProductId: productId, DiscountTypeId: discountTypeId, PriceValue: priceValue, PercentageValue: percentageValue,
                            PointRequired: pointRequired, Name: name, StartDate: startDate, EndDate: endDate
                        },
                        url: '/Admin/Products/AddProductDiscount',
                        success: function (response) {
                            if (response.successful) {
                                toastr.success(response.message);
                                $('#EditDiscount').modal("hide");
                                GetProductDiscountList(productId);
                            }
                            else
                                toastr.error(response.message);
                        },
                        error: function (error) {
                            toastr.error(error);
                        }
                    });
                }
                else {
                    var id = $("#selectCreatedDiscount").val();
                    var discountTypeId = $('#selectDiscountType').val();
                    var pointRequired = $('#EditDiscountPoint').val();
                    var name = "";
                    var priceValue = 0.00;
                    var percentageValue = 0.00;
                    var pointRequired = 0;

                    if (discountTypeId == 1) {
                        percentageValue = $('#EditDiscountValue').val();
                        pointRequired = $('#EditDiscountPoint').val();
                        name = percentageValue + "% DISCOUNT (" + pointRequired + " Points)";
                    }
                    else if (discountTypeId == 2) {
                        priceValue = $('#EditDiscountValue').val();
                        pointRequired = $('#EditDiscountPoint').val();
                        name = "RM" + priceValue + " DISCOUNT (" + pointRequired + " Points)";
                    }
                    else {
                        priceValue = $('#EditDiscountValue').val();
                        pointRequired = $('#EditDiscountPoint').val();
                        name = "RM" + priceValue + " DISCOUNT (" + pointRequired + " Points)";
                    }

                    var startDate = $('#EditDiscountStartDate').val();
                    var endDate = $('#EditDiscountEndDate').val();

                    $.ajax({
                        type: "POST",
                        dataType: 'json',
                        data: {
                            Id: id, DiscountTypeId: discountTypeId, PriceValue: priceValue, PercentageValue: percentageValue,
                            PointRequired: pointRequired, Name: name, StartDate: startDate, EndDate: endDate
                        },
                        url: '/Admin/Products/UpdateProductDiscount',
                        success: function (response) {
                            if (response.successful) {
                                toastr.success(response.message);
                                $('#EditDiscount').modal("hide");
                                GetProductDiscountList(productId);
                            }
                            else
                                toastr.error(response.message);
                        },
                        error: function (error) {
                            toastr.error(error);
                        }
                    });
                }
            });
            $("#selectDiscountType").change(function () {
                if ($(this).val() == 1) {
                    $("#EditDiscountValue").unbind();
                    $("#discountUnit").html("(%)");
                    $("#RequiredDiscountedValue").html("Point Required");
                    $("#EditDiscountValue").removeAttr("disabled");
                    $("#EditDiscountPoint").removeAttr("disabled");
                    $("#EditDiscountStartDate").removeAttr("disabled");
                    $("#EditDiscountEndDate").removeAttr("disabled");
                    $("#UpdateDiscount").show();
                } else if ($(this).val() == 2) {
                    $("#EditDiscountValue").unbind();
                    $("#discountUnit").html("(RM)");
                    $("#RequiredDiscountedValue").html("Point Required");
                    $("#EditDiscountValue").removeAttr("disabled");
                    $("#EditDiscountPoint").removeAttr("disabled");
                    $("#EditDiscountStartDate").removeAttr("disabled");
                    $("#EditDiscountEndDate").removeAttr("disabled");
                    $("#UpdateDiscount").show();
                }
                else {
                    $("#discountUnit").html("(RM)");
                    $("#RequiredDiscountedValue").html("Point Required");
                    $("#EditDiscountValue").removeAttr("disabled");
                    $("#EditDiscountPoint").attr("disabled", "disabled");
                    //$("#EditDiscountPoint").removeAttr("disabled");
                    $("#EditDiscountValue").on('change keyup paste', function (e) {
                        var price = $("#EditDiscountValue").val();
                        $("#EditDiscountPoint").val(Math.round(price / rinngitToPoints));
                    });

                    $("#EditDiscountStartDate").removeAttr("disabled");
                    $("#EditDiscountEndDate").removeAttr("disabled");
                    $("#UpdateDiscount").show();
                }
                //else if ($(this).val() == 4) {
                //    $("#discountUnit").html("(%)");
                //    $("#RequiredDiscountedValue").html("RM Required");
                //    $("#EditDiscountValue").removeAttr("disabled");
                //    $("#EditDiscountPoint").removeAttr("disabled");
                //    $("#EditDiscountStartDate").removeAttr("disabled");
                //    $("#EditDiscountEndDate").removeAttr("disabled");
                //    $("#UpdateDiscount").show();
                //}
                //else if ($(this).val() == 5) {
                //    $("#discountUnit").html("(Points)");
                //    $("#RequiredDiscountedValue").html("RM Required");
                //    $("#EditDiscountValue").removeAttr("disabled");
                //    $("#EditDiscountPoint").removeAttr("disabled");
                //    $("#EditDiscountStartDate").removeAttr("disabled");
                //    $("#EditDiscountEndDate").removeAttr("disabled");
                //    $("#UpdateDiscount").show();
                //}
            });
            $("#btnEditDiscount").click(function () {
                var dealType = $('#EditDealTypeList').val();
                $('#UpdateDiscount').attr("status-id", "edit");
                $('#EditDiscount').find(".modal-title").html("Edit Discount");
                $("#divCreatedDiscountList").show();
                $('#EditDiscount').attr("data-id", "0");
                GetDiscountTypeList(dealType);
                var productId = $('#productId').attr("data-id");
                GetProductDiscountList(productId);
                $('#EditDiscountValue').val(0);
                $('#EditDiscountPoint').val(0);
                $("#EditDiscountStartDate").val(moment().format("YYYY-MM-DD"));
                $("#EditDiscountEndDate").val(moment().add(2, 'years').format("YYYY-MM-DD"));
                $("#EditDiscountValue").attr("disabled", "disabled");
                $("#EditDiscountPoint").attr("disabled", "disabled");
                $("#EditDiscountStartDate").attr("disabled", "disabled");
                $("#EditDiscountEndDate").attr("disabled", "disabled");
                $("#UpdateDiscount").hide();
                $("#divEditDiscount").hide();
                $('#EditDiscount').modal("show");
            });

            $("#btnAddDiscount").click(function () {
                var dealType = $('#EditDealTypeList').val();
                if (dealType == 1) {
                    $('#EditProductPriceOrPoints').val("RM " + $("#actualproductPrice").val());
                } else if (dealType == 2) {
                    $('#EditProductPriceOrPoints').val("RM " + $("#EditDiscountedPrice").val());
                } else {
                    $('#EditProductPriceOrPoints').val("RM " + $("#EditDiscountedPrice").val());
                }
                $('#UpdateDiscount').attr("status-id", "add");
                $('#EditDiscount').find(".modal-title").html("Add Discount");
                $("#divCreatedDiscountList").hide();
                $('#EditDiscount').attr("data-id", "0");
                GetDiscountTypeList(dealType);
                $('#EditDiscountValue').val(0);
                $('#EditDiscountPoint').val(0);
                $("#EditDiscountStartDate").val(moment().format("YYYY-MM-DD"));
                $("#EditDiscountEndDate").val(moment().add(2, 'years').format("YYYY-MM-DD"));
                $("#EditDiscountValue").attr("disabled", "disabled");
                $("#EditDiscountPoint").attr("disabled", "disabled");
                $("#EditDiscountStartDate").attr("disabled", "disabled");
                $("#EditDiscountEndDate").attr("disabled", "disabled");
                $("#UpdateDiscount").hide();
                $("#divEditDiscount").show();

                $('#EditDiscount').modal("show");
            });

            $(".btn-file").click(function () {
                $('#EditImage').click();
            });

            $(".btn-outlet-file").click(function () {
                $('#EditOutletImage').click();
            });

            $('#EditOutletImage').on('change', function () {
                imagesOutletPreview(this, '#outletImageGallery');
            });

            $('#EditImage').on('change', function () {
                imagesPreview(this, '#imageGallery');
            });
            $("#EditCategoryList").change(function () {
                GetProductSubcategoryList($(this).val());
            });

            $("#btnUpdateLuckyDrawDate").click(function () {
                var productId = $('#productId').attr("data-id");
                var luckyDrawDate = $('#EditLuckyDrawDate').val();
                if (luckyDrawDate == null || luckyDrawDate == "") {
                    toastr.error("Invalid Date");
                    $('#EditLuckyDrawDate').focus();
                    return;
                }
                $.ajax({
                    type: "POST",
                    dataType: 'json',
                    data: {
                        ProductId: productId, LuckyDrawDate: luckyDrawDate
                    },
                    url: '/Admin/Products/UpdateLuckyDrawDate',
                    success: function (response) {
                        if (response.successful) {
                            toastr.success(response.message);
                        }
                        else
                            toastr.error(response.message);
                    },
                    error: function (error) {
                        toastr.error(error);
                    }
                });
            });

            $("#btnUpdateWinningTicket").click(function () {
                $("#WinningTicketModal").modal("show");
            });

            $("#UpdateWinningTicket").click(function () {
                var productId = $('#productId').attr("data-id");
                var winningTicketId = $('#EditUpdateWinningTicketId').val();

                $.ajax({
                    type: "POST",
                    dataType: 'json',
                    data: {
                        ProductId: productId, WinningTicket: winningTicketId
                    },
                    url: '/Admin/Products/UpdateLuckyDrawWinningTicket',
                    success: function (response) {
                        if (response.successful) {
                            toastr.success(response.message);
                            $("#EditWinningTicketId").val(winningTicketId);
                            $("#WinningTicketModal").modal("hide");
                        }
                        else
                            toastr.error(response.message);
                    },
                    error: function (error) {
                        toastr.error(error);
                    }
                });
            });


            $("#EditRedemptionStartDate").val(moment().format("YYYY-MM-DD"));
            $("#EditRedemptionEndtDate").val(moment().format("YYYY-MM-DD"));
            $("#EditStartDate").val(moment().format("YYYY-MM-DD"));
            $("#EditEndDate").val(moment().add(2, 'years').format("YYYY-MM-DD"));
            $('#EditDigitalRedemptionOption').change(function () {
                if ($(this).val() == 1) {
                    $('#redemptionDigitalURL').hide();
                }
                else if ($(this).val() == 2) {
                    $('#redemptionDigitalURL').show();
                }
                else
                    $('#redemptionDigitalURL').hide();
            });
            $('#EditDealTypeList').change(function () {
                if ($(this).val() == 0) {
                    $('#discount-tab-justify').closest('.nav-item').hide();
                    $('#luckydraw-tab-justify').closest('.nav-item').hide();
                    $('#priceTypeDiv').hide();
                    $('#pointTypeDiv').hide();
                }
                else if ($(this).val() == 1) {
                    $('#discount-tab-justify').closest('.nav-item').show();
                    $('#luckydraw-tab-justify').closest('.nav-item').hide();
                    $('#priceTypeDiv').hide();
                    $('#pointTypeDiv').show();
                }
                else if ($(this).val() == 2) {
                    $('#discount-tab-justify').closest('.nav-item').show();
                    $('#luckydraw-tab-justify').closest('.nav-item').hide();
                    if (!$("#isProductVariationEnabled").prop("checked")) {
                        $('#priceTypeDiv').show();
                    }
                    $('#pointTypeDiv').hide();
                }
                else if ($(this).val() == 3) {
                    var productId = $('#productId').attr("data-id");
                    GetProductLuckyDraw(productId);
                    $('#discount-tab-justify').closest('.nav-item').hide();
                    $('#luckydraw-tab-justify').closest('.nav-item').show();
                    $('#priceTypeDiv').hide();
                    $('#pointTypeDiv').show();
                }
                else {
                    $('#discount-tab-justify').closest('.nav-item').hide();
                    $('#luckydraw-tab-justify').closest('.nav-item').hide();
                    $('#priceTypeDiv').hide();
                    $('#pointTypeDiv').hide();
                }
            });
            $('#EditDealExpirationList').change(function () {
                if ($(this).val() == 0) {
                    $('#redemptionDays').hide();
                    $('#redemptionDate').hide();
                    $('#redemptionDigital').hide();
                }
                else if ($(this).val() == 1) {
                    $('#redemptionDigital').hide();
                    $('#redemptionDate').hide();
                    $('#redemptionDays').show();
                }
                else if ($(this).val() == 2) {
                    $('#redemptionDate').show();
                    $('#redemptionDays').hide();
                    $('#redemptionDigital').hide();
                }
                else if ($(this).val() == 4) {
                    $('#redemptionDigital').show();
                    $('#redemptionDate').hide();
                    $('#redemptionDays').hide();
                    $('#EditDigitalRedemptionOption').change();
                }
                else {
                    $('#redemptionDigital').hide();
                    $('#redemptionDate').hide();
                    $('#redemptionDays').hide();
                }
            });
            $("#btnUpdateRedemption").click(function () {
                var productId = $('#productId').attr("data-id");
                var expirationTypeId = $("#EditDealExpirationList").val();
                if (expirationTypeId == 0) {
                    toastr.error("Please choose a Product Type");
                    $("#EditDealExpirationList").focus();
                    return;
                }
                var startDate = $("#EditRedemptionStartDate").val();
                var expiredDate = $("#EditRedemptionEndtDate").val();
                var totalValidDays = $("#EditRedemptionDays").val();
                UpdateProductDealExpiration(productId, expirationTypeId, startDate, expiredDate, totalValidDays)
            });
            $('#btnUpdateOutlet').click(function () {
                var productId = $('#productId').attr("data-id");
                var selected = $('#EditOutletList').val();
                $.ajax({
                    type: "POST",
                    dataType: 'json',
                    data: {
                        ProductId: productId, OutletsId: selected
                    },
                    url: '/Admin/Products/UpdateProductOutlets',
                    success: function (response) {
                        if (response.successful)
                            toastr.success(response.message);
                        else
                            toastr.error(response.message);
                    },
                    error: function (error) {
                        toastr.error(error);
                    }
                });
            });
            //$('#btnReview').click(function () {
            //    GetStatusTypeList();
            //    GetProductPendingChanges($('#productId').attr("data-id"));
            //    $("#productStatusList").val($("#ReviewProduct").attr("status-id"));
            //    // $("#productStatusRemarks").val($("#ReviewProduct").attr("remarks"));
            //    $('#ReviewProduct').modal("show");
            //});
            $("#UpdateProductStatus").click(function () {
                var productId = $('#productId').attr("data-id");
                var statusId = $("#productStatusList").val();
                var remarks = $("#productStatusRemarks").val();
                UpdateProductStatus(productId, statusId, remarks);
            });
            $("#btnUpdateProduct").click(function () {
                document.getElementById('EditDescription').value = editDescription.root.innerHTML;
                document.getElementById('EditAdditionInfo').value = editAdditionInfo.root.innerHTML;
                document.getElementById('EditFinePrint').value = editFinePrint.root.innerHTML;
                document.getElementById('EditRedemptionInfo').value = editRedemptionInfo.root.innerHTML;
                var productId = $('#productId').attr("data-id");
                var imagefilesname = $("#productId").attr("image-url");

                // Read selected files
                var imagefiles = document.getElementById("EditImage").files[0];
                if (filesList.length > 0) {
                    var formData = new FormData();
                    var totalfiles = filesList.length;// document.getElementById('EditImage').files.length;
                    for (var index = 0; index < totalfiles; index++) {
                        formData.append("files[]", filesList[index]);
                    }
                    //formData.append("EditCompanyLogo", logofile);
                    $.ajax({
                        url: "/Admin/Products/UploadProductImages/" + productId,
                        type: "POST",
                        async: false,
                        data: formData,
                        enctype: 'multipart/form-data',
                        processData: false, // tell jQuery not to process the data
                        contentType: false // tell jQuery not to set contentType
                    }).done(function (response) {
                        if (response.successful) {
                            imagefilesname = response.data;
                            toastr.success(response.message);
                            filesList = [];
                        }
                        else
                            toastr.error(response.message);
                        // $("#merchantLogo").attr("src", response.data);
                    });
                }
                if (removefilesList.length > 0)
                    DeleteProductImages(productId);

                var dealTypeId = $("#EditDealTypeList").val();
                if (dealTypeId == 0) {
                    toastr.error("Please choose Deal Type");
                    $("#EditDealTypeList").focus();
                    return;
                }
                var title = $("#EditTitle").val();
                var subtitle = $("#EditSubtitle").val();
                var categoryId = $("#EditCategoryList").val();
                var subcategoryId = $("#EditSubcategoryList").val();
                if (categoryId == 0) {
                    toastr.error("Please choose product category");
                    $("#EditCategoryList").focus();
                    return;
                }
                if (subcategoryId == 0) {
                    toastr.error("Please choose product subcategory");
                    $("#EditSubcategoryList").focus();
                    return;
                }
                var startDate = $("#EditStartDate").val();
                var endDate = $("#EditEndDate").val();
                var description = editDescription.root.innerHTML;
                var addtionInfo = editAdditionInfo.root.innerHTML;
                var finePrint = editFinePrint.root.innerHTML;
                var redemptionInfo = editRedemptionInfo.root.innerHTML;
                var quantity = $("#EditQuantity").val();
                var pointRequired = $("#EditPointRequired").val();
                var actualPriceVpoint = $("#actualproductPrice").val();
                var price = parseFloat($("#EditPrice").val());
                if (isNaN(price)) {
                    toastr.error("Price must be a number");
                    $("#EditPrice").focus();
                    return;
                }

                var isDiscountedPriceEnabled = $("#IsDiscountedPriceEnabled").prop("checked");

                var discountedPrice = price;

                if (isDiscountedPriceEnabled) {
                    discountedPrice = parseFloat($("#EditDiscountedPrice").val());
                }
                else {
                    $("#EditDiscountedPrice").val(price);
                }

                if (isNaN(discountedPrice)) {
                    toastr.error("Discounted Price must be a number");
                    $("#EditDiscountedPrice").focus();
                    return;
                }
                else if (discountedPrice < 0) {
                    toastr.error("Discounted Price can not be negative number");
                    $("#EditDiscountedPrice").focus();
                    return false;
                }
                else if (discountedPrice > price) {
                    toastr.error("Discounted Price can not be more than the Original Price");
                    $("#EditDiscountedPrice").focus();
                    return false;
                }

                var discountRate = Math.floor((price - discountedPrice) / price);

                var thirdPartyTypeId = $("#OutletModel_ThirdPartyTypeId").val();
                var thirdPartyProductId = $("#OutletModel_ThirdPartyProductId").val();

                if (thirdPartyTypeId == "") {
                    thirdPartyProductId = "";
                }
                var isShareShippingDifferentItem = $('#isShareShippingDifferentItem').prop("checked");
                var shareShippingCostSameItem = $('#shareShippingCostSameItem').val();

                $.ajax({
                    type: "POST",
                    dataType: 'json',
                    data: {
                        ProductId: productId, Title: title, Subtitle: subtitle,
                        Description: description, AdditionInfo: addtionInfo,
                        FinePrintInfo: finePrint, RedemptionInfo: redemptionInfo,
                        ProductCategoryId: categoryId, ProductSubCategoryId: subcategoryId,
                        DealTypeId: dealTypeId, StartDate: startDate, EndDate: endDate, Price: price,
                        DiscountedPrice: discountedPrice, DiscountRate: discountRate, PointsRequired: pointRequired, ActualPriceForVpoints: actualPriceVpoint, AvailableQuantity: quantity,
                        ImageFolderUrl: imagefilesname,
                        thirdPartyTypeId: thirdPartyTypeId,
                        thirdPartyProductId: thirdPartyProductId,
                        IsDiscountedPriceEnabled: isDiscountedPriceEnabled,
                        IsShareShippingDifferentItem : isShareShippingDifferentItem,
                        ShareShippingCostSameItem : shareShippingCostSameItem
                    },
                    url: '/Admin/Products/UpdateProduct',
                    success: function (response) {
                        if (response.successful) {
                            toastr.success(response.message);
                            $("#imageGallery").html("");
                            GetProductImages(productId);
                        } else
                            toastr.error(response.message);
                    },
                    error: function (error) {
                        toastr.error(error);
                    }
                });
            });

            $("#isProductVariationEnabled").click(function () {
                if ($(this).prop("checked")) {
                    $(".variation-parent-div").show();
                    $("#priceTypeDiv").hide();
                    $(".product-quantity").hide();
                    $(".product-pricing-quantity-message").show();

                }
                else {
                    $(".variation-parent-div").hide();
                    $("#priceTypeDiv").show();
                    $(".product-quantity").show();
                    $(".product-pricing-quantity-message").hide();
                }
            });


            GetExpirationTypeList();
            var productId = $('#productId').attr("data-id");
            GetProduct(productId);

            var merchantId = $('#EditMerchantCode').attr("data-id");
            GetMerchantOutletList(merchantId);
            GetProductOutlets(productId);

            $('#EditOutletList').multiSelect({ selectableOptgroup: true });
            $('#EditValidDiscountList').multiSelect({ selectableOptgroup: true });

            GetProductDiscountList(productId);
            UpdateBadge();
            GetProductImages(productId);
            $("#allDiv").show();

            $(".btn_apply_all").click(function () {
                startTime = $(this).parent().parent().parent().find(".from-time").val();
                endTime = $(this).parent().parent().parent().find(".end-time").val();
                $(".card-working-hours").each(function () {
                    $(this).find(".from-time").val(startTime);
                    $(this).find(".end-time").val(endTime);
                });
            });

            //Variation images

            var variationImagesPreview = function (input, placeToInsertImagePreview) {

                if (input.files) {
                    var index = 0;
                    $(".product-variation-img-preview-container").each(function () {
                        $(this).attr("index", index);
                        index++;
                    });
                    var filesAmount = input.files.length;

                    var variation1count = $(".variation1-card").find("li").length;
                    if (filesAmount > (variation1count - variationImagesList.length)) {
                        toastr.error("Maximum of " + variation1count + " files allowed.");
                        return false;
                    }
                    var imageNumber = 0;
                    getUnattachedVariationImagesIndexes();

                    for (i = 0; i < filesAmount; i++) {
                        var reader = new FileReader();
                        var validDimentions = false;
                        reader.onload = function (event) {
                            var image = new Image();
                            validDimentions = false;
                            //Set the Base64 string return from FileReader as source.
                            image.src = event.target.result;

                            //Validate the File Height and Width.
                            image.onload = function () {

                                var height = this.height;
                                var width = this.width;

                                var size = Math.round((input.files[imageNumber].size / 1024));
                                if (width > imageMinwidth && width < imageMaxwidth && height > imageMinHeight && height < imageMaxHeight && size > 0 && size < imageMaxSize) {
                                    validDimentions = true;
                                }
                                if (input.files[imageNumber].type == "image/png" || input.files[imageNumber].type == "image/jpeg" || input.files[imageNumber].type == "image/jpg" || input.files[imageNumber].type == "image/jfif") {
                                    if (validDimentions) {
                                        $($.parseHTML('<div class="product-variation-img-preview-container" index="' + index + '" variationName= "' + $($(".variation1-card").find("input")[unattachedVariationImagesIndexes[imageNumber]]).val() + '"><img src="' + event.target.result + '" name="' + input.files[imageNumber].name + '" class="product-img-preview"/><span class="remove-variation-img">Remove image</span><span class="variation-image-name">' + ($($(".variation1-card").find("input")[unattachedVariationImagesIndexes[imageNumber]]).val() == "" ? "Option" : $($(".variation1-card").find("input")[unattachedVariationImagesIndexes[imageNumber]]).val()) + '</span></div>')).appendTo(placeToInsertImagePreview);
                                        setRemoveVariationImageEvent();
                                        sortVariationImagesBasedOnTheOptionsOrder();
                                        updateVariationOneImagesTextLabel();
                                    }
                                    else {
                                        variationImagesList.pop();
                                        toastr.error("Please ensure that each image file has the following dimensions and file size: Width: \n Between" + imageMinwidth + " to " + imageMaxwidth + "px \n Height: Between " + imageMinHeight + " to " + imageMaxHeight + "px \n Size: Less than " + imageMaxSize + "KB");
                                    }
                                    index++;
                                }
                                imageNumber++;

                            }
                        }


                        if (input.files[i].type == "image/png" || input.files[i].type == "image/jpeg" || input.files[i].type == "image/jpg" || input.files[i].type == "image/jfif") {

                            variationImagesList.push(input.files[i]);
                            reader.readAsDataURL(input.files[i]);

                        }
                        else {
                            imageNumber++;
                            toastr.error("Please upload files having extensions: <b>png, jpeg, jpg, jfif</b> only");
                        }
                    }
                }
                //sortVariationImages();
            };

            $('#EditVariationImage').on('change', function () {
                variationImagesPreview(this, '#variationimageGallery');

            });
            $(".btn-variation-file").click(function () {
                $('#EditVariationImage').click();
            });


            $("#variationimageGallery").sortable({
                start: function (event, ui) {
                    var start_pos = ui.item.index();
                    ui.item.data('start_pos', start_pos);
                },
                change: function (event, ui) {
                    //  var start_pos = ui.item.data('start_pos');
                    // var index = ui.placeholder.index();
                    //  alert(start_pos);
                    //          alert(index);
                },
                update: function (event, ui) {

                    var start_pos = ui.item.data('start_pos');
                    var index = ui.item.index();
                    var temp = variationImagesList[start_pos];
                    //var temp1 = variationImagesList[index];
                    variationImagesList.splice(start_pos, 1);
                    variationImagesList.splice(index, 0, temp);

                    sortVariationImages();

                }, swapThreshold: 1

            });




            $('#btnUpdateVariation').click(function () {
                var productId = $('#productId').attr("data-id");

                if (!$("#isProductVariationEnabled").prop("checked")) {
                    $.ajax({
                        type: "POST",
                        data: {
                            status: $("#isProductVariationEnabled").prop("checked")
                        },
                        url: '/Admin/Products/UpdateProductVariationStatus/' + parseInt(productId),
                        contentType: "application/json",
                        success: function (response) {
                            if (response.successful)
                                toastr.success(response.message);
                            else
                                toastr.error(response.message);
                        },
                        error: function (error) {
                            toastr.error(error);
                        }
                    });
                    $(variationImagesList).each(function (imagesIndex) {
                        removeVariationImagesList.push(this.name);
                    });
                    $("#variationimageGallery").find("span").remove();
                    variationImagesList = [];
                    DeleteProductVariationImages(productId);
                    return;
                }
                if (isInformationValid()) {
                    var productVariationDetailsList = [];
                    var variationList = [];

                    $(".variation-table").find(".variation2-group").each(function (index) {
                        var order = index;
                        if (!$(".variation2-add-btn").is(":visible")) {
                            $(this).children().each(function (InnerIndex) {
                                productVariationDetailsList.push({
                                    Id: isNaN(parseInt($(this).attr("id"))) == true ? 0 : parseInt($(this).attr("id")),
                                    Price: isNaN(parseFloat($(this).find(".variation-price-input").val())) == true ? 0 : parseFloat($(this).find(".variation-price-input").val()),
                                    AvailableQuantity: isNaN(parseInt($(this).find(".variation-stock-input").val())) == true ? 0 : parseInt($(this).find(".variation-stock-input").val()),
                                    Sku: $(this).find(".variation-sku-input").val(),
                                    DiscountedPrice: isNaN(parseFloat($(this).find(".variation-discounted-price-input").val())) == true ? 0 : parseFloat($(this).find(".variation-discounted-price-input").val()),
                                    IsDiscountedPriceEnabled: $(this).find(".variation-discounted-price-checkbox").prop("checked"),
                                    Order: order + "," + InnerIndex
                                });
                            });
                        }
                        else {
                            $(this).children().each(function (InnerIndex) {
                                productVariationDetailsList.push({
                                    Id: isNaN(parseInt($(this).attr("id"))) == true ? 0 : parseInt($(this).attr("id")),
                                    Price: isNaN(parseFloat($(this).find(".variation-price-input").val())) == true ? 0 : parseFloat($(this).find(".variation-price-input").val()),
                                    AvailableQuantity: isNaN(parseInt($(this).find(".variation-stock-input").val())) == true ? 0 : parseInt($(this).find(".variation-stock-input").val()),
                                    Sku: $(this).find(".variation-sku-input").val(),
                                    DiscountedPrice: isNaN(parseFloat($(this).find(".variation-discounted-price-input").val())) == true ? 0 : parseFloat($(this).find(".variation-discounted-price-input").val()),
                                    IsDiscountedPriceEnabled: $(this).find(".variation-discounted-price-checkbox").prop("checked"),
                                    Order: order.toString()
                                });
                            });
                        }
                    });

                    // Variation1
                    var variationName = $(".variation1-card").find(".variation-name-input").val();
                    var variationId = isNaN(parseInt($(".variation1-card").find(".variation-name-input").attr("id"))) == true ? 0 : parseInt($(".variation1-card").find(".variation-name-input").attr("id"));

                    var isFirstVariation = true;
                    var variationOptions = [];

                    $(".variation1-card").find(".variation-option-input").each(function (index) {
                        variationOptions.push({ Id: isNaN(parseInt($(this).attr("id"))) == true ? 0 : parseInt($(this).attr("id")), Name: $(this).val(), Order: index });

                    });
                    variationList.push({
                        Id: variationId,
                        Name: variationName,
                        ProductId: parseInt(productId),
                        IsFirstVariation: isFirstVariation,
                        VariationOptions: variationOptions
                    });

                    // Variation2
                    if (!$(".variation2-add-btn").is(":visible")) {
                        variationName = $(".variation2-section").find(".variation-name-input").val();
                        variationId = isNaN(parseInt($(".variation2-section").find(".variation-name-input").attr("id"))) == true ? 0 : parseInt($(".variation2-section").find(".variation-name-input").attr("id"));
                        isFirstVariation = false;
                        variationOptions = [];


                        $(".variation2-section").find(".variation-option-input").each(function (index) {
                            variationOptions.push({ Id: isNaN(parseInt($(this).attr("id"))) == true ? 0 : parseInt($(this).attr("id")), Name: $(this).val(), Order: index, ImageUrl: "" });

                        });

                        variationList.push({
                            Id: variationId,
                            Name: variationName,
                            ProductId: parseInt(productId),
                            IsFirstVariation: isFirstVariation,
                            VariationOptions: variationOptions
                        });
                    }

                    //Read selected files
                    var imagefiles = document.getElementById("EditVariationImage").files[0];
                    if (variationImagesList.length != 0) {
                        var formData = new FormData();
                        var totalfiles = variationImagesList.length;// document.getElementById('EditImage').files.length;
                        var variation1count = $(".variation1-card").find("li").length;
                        if (totalfiles < variation1count) {
                            toastr.error("Please upload all variation 1 images");
                            return;
                        }
                        for (var index = 0; index < totalfiles; index++) {
                            formData.append("files[]", variationImagesList[index]);
                        }

                        if (removeVariationImagesList.length > 0)
                            DeleteProductVariationImages(productId);
                        $.ajax({
                            url: "/Admin/Products/AddProductVariationImages/" + productId,
                            type: "POST",
                            async: false,
                            data: formData,
                            enctype: 'multipart/form-data',
                            processData: false, // tell jQuery not to process the data
                            contentType: false // tell jQuery not to set contentType
                        }).done(function (response) {
                            if (response.successful) {
                                imagefilesname = response.data;
                                //toastr.success(response.message);
                                variationImagesList = [];
                                $("#imageGallery").html("");
                                getProductVariationImages(productId);
                            }
                            else {
                                toastr.error(response.message);
                                return;
                            }

                        });
                    }
                    else {
                        toastr.error("Please upload variation 1 images");
                        return;
                    }

                    var object = {
                        ProductId: parseInt(productId),
                        VariationList: variationList,
                        ProductVariationDetailsList: productVariationDetailsList
                    };

                    $.ajax({
                        type: "POST",
                        data: JSON.stringify(object),
                        url: '/Admin/Products/AddProductVariation',
                        contentType: "application/json",
                        success: function (response) {
                            if (response.successful)
                                toastr.success(response.message);
                            else
                                toastr.error(response.message);
                        },
                        error: function (error) {
                            toastr.error(error);
                        }
                    });
                }
            });

            $(".variation-discounted-price-checkbox").click(function () {
                if ($(this).prop("checked")) {
                    $(this).parents().eq(2).find(".variation-discounted-price-input").prop("disabled", false).val(0);
                }
                else {
                    $(this).parents().eq(2).find(".variation-discounted-price-input").prop("disabled", true);
                }
            });

            $("#isDiscountedPriceEnabledApplyAll").click(function () {
                if ($(this).prop("checked")) {
                    $(".variation-discounted-price-applyall-input").prop("disabled", false);
                }
                else {
                    $(".variation-discounted-price-applyall-input").prop("disabled", true);
                }
            });


            $(".first-variation-close").click(function () {

                //Better way to make variation 2 replace variation 1 if existed when closing variation 1
                //if ($(".variation2-add-btn").is(":visible")) {
                //}
                //else {

                //}
                $("#isProductVariationEnabled").prop("checked", false);
                $(".variation-parent-div").hide();
                $(".second-variation-close").click();

                $(".variation-table").children().each(function (index) {
                    if (!$(this).hasClass("table-headers") && index > 1) {
                        $(this).remove();
                    }
                    else if ($(this).hasClass("table-headers")) {
                        $(this).children().eq(0).html("Name");
                    }
                    else {
                        $(this).children().eq(0).html("Option");
                    }

                    $(".variation1-card").find(".variation-name-input").val("");

                    $(".variation1-card").find(".list-group-item").each(function (index) {
                        if (index != 0) {
                            $(this).remove();
                        }
                        else {
                            $(this).find(".variation-option-input").val("");
                            $(this).find(".variation-option-delete-btn").hide();

                        }
                    })
                });

            });

            $(".second-variation-close").click(function () {
                $(".variation2-add-btn").parent().show();
                $(".variation2-section").hide();
                //Update the styles and delete the variation options
                $(".variation-table").children().each(function () {
                    if (!$(this).hasClass("table-headers")) {
                        $(this).children().eq(1).css("flex", "15 1 0%");
                        $(this).children().eq(1).children().eq(0).children().eq(0).hide();
                        $(this).children().eq(1).children().eq(0).children().eq(0).html("Option");
                        $(this).children().eq(1).children().eq(0).siblings().remove();
                    }
                    else {
                        $(this).children().eq(1).hide();
                        $(this).children().eq(1).html("Name");
                    }
                    $(".variation-table-cell").removeClass("flex-expand");
                    $(".variation2-section").find(".variation-name-input").val("");
                    $(".variation2-section").find(".list-group-item").each(function (index) {
                        if (index != 0) {
                            $(this).remove();
                        }
                        else {
                            $(this).find(".variation-option-input").val("");
                            $(this).find(".variation-option-delete-btn").hide();

                        }
                    });
                });
                unableAddingNewVariation();
                $(".variation2-section").find(".variation-option-add-btn-text").html("  Add Options (" + 2 + "/20)");
            });

            $(".sortable-lists").sortable({
                start: function (event, ui) {
                    var start_pos = ui.item.index();
                    ui.item.data('start_pos', start_pos);
                },
                update: function (event, ui) {
                    var index = ui.item.index();
                    var start_pos = ui.item.data('start_pos');

                    if (ui.item.parent().parents().hasClass("variation1-card")) {
                        if (start_pos - index > 0) {
                            $(".variation-table").children().eq(index).after($(".variation-table").children().eq(start_pos + 1));
                        }
                        else {
                            $(".variation-table").children().eq(index + 1).after($(".variation-table").children().eq(start_pos + 1));
                        }
                        sortVariationImages();
                    }
                    else {
                        $(".variation-table").find(".variation2-group").each(function () {

                            if (start_pos - index > 0) {
                                if (index == 0) {
                                    $(this).prepend($(this).children().eq(start_pos));

                                }
                                else {
                                    $(this).children().eq(index - 1).after($(this).children().eq(start_pos));
                                }
                            }
                            else {
                                $(this).children().eq(index).after($(this).children().eq(start_pos));
                            }
                        });


                    }

                }

            });
            $(".variationOptionsSort").on('mousedown', function () {
                $(".sortable-lists").sortable("enable");
                $(".sortable-lists").disableSelection();
                $(".variationOptionsSort").css("cursor", "grabbing");


            }).on('mouseup mouseleave', function () {
                $(".sortable-lists").sortable("disable");
                $(".variationOptionsSort").css("cursor", "grab");

            });


            // Variation
            $("#btnVariationApplyToAll").click(function () {
                var sku = $(".variation-sku-applyall-input").val();
                var stock = $(".variation-stock-applyall-input").val();
                var price = $(".variation-price-applyall-input").val();
                var discountedPrice = $(".variation-discounted-price-applyall-input").val();
                var isDiscountedPriceEnabled = $("#isDiscountedPriceEnabledApplyAll").prop("checked");

                $(".variation-price-input").val(price);
                $(".variation-stock-input").val(stock);
                $(".variation-sku-input").val(sku);
                $(".variation-discounted-price-input").val(discountedPrice);
                $(".variation-discounted-price-checkbox").prop("checked", isDiscountedPriceEnabled);
                if (isDiscountedPriceEnabled) {
                    $(".variation-discounted-price-input").prop("disabled", false);
                }
                else {
                    $(".variation-discounted-price-input").prop("disabled", true);
                }


            });

            $(".variation2-add-btn").click(function () {
                $(this).parent().hide();
                $(".variation2-section").show();
                $(".variation-table").children().each(function () {
                    if (!$(this).hasClass("table-headers")) {
                        $(this).children().eq(1).css("flex", "12 1 0%");
                        $(this).children().eq(1).children().eq(0).children().eq(0).show();
                    }
                    else {
                        $(this).children().eq(1).show();
                    }
                    $(".variation-table-cell").addClass("flex-expand")
                });

            });

            $(".variation-name-input").keyup(function () {
                $(this).parent().find(".character-counter").first().html($(this).val().length + "/14");
                var text = $(this).val();
                if ($(this).parents().parents().parents().parents().hasClass("variation1-card")) {
                    if ($(this).val() == "") {
                        $(".variation-table").children().eq(0).children().eq(0).html("Name");
                        $(".image-variation-label").html("Variation 1");
                    }
                    else {
                        $(".variation-table").children().eq(0).children().eq(0).html(text);
                        $(".image-variation-label").html("Variation 1 (" + $(this).val() + ")");
                    }
                }
                else {
                    if ($(this).val() == "")
                        $(".variation-table").children().eq(0).children().eq(1).html("Name");
                    else
                        $(".variation-table").children().eq(0).children().eq(1).html($(this).val());
                }
            });

            $(".variation-option-input").keyup(function () {
                $(this).parent().find(".character-counter").first().html($(this).val().length + "/20");
                var orderNumber = $(this).parent().parent().parent().prevAll().length + 1;
                var text = $(this).val();
                if ($(this).parents().parents().parents().parents().hasClass("variation1-card")) {
                    if (text == "") {
                        $(".variation-table").children().eq(orderNumber).children().eq(0).html("Option");
                        $(".variation-gallery").find(".variation-image-name").eq(orderNumber - 1).html("Option");
                    }
                    else {
                        $(".variation-table").children().eq(orderNumber).children().eq(0).html(text);
                        $(".variation-gallery").find(".variation-image-name").eq(orderNumber - 1).html(text);
                    }
                    updateVariationOneImagesTextLabel();
                }
                else {
                    $(".variation-table").children().each(function () {
                        if (!$(this).hasClass("table-headers")) {
                            if (text == "")
                                $(this).find(".variation2-group").children().eq(orderNumber - 1).children().eq(0).html("Option");
                            else
                                $(this).find(".variation2-group").children().eq(orderNumber - 1).children().eq(0).html(text);
                        }
                    });
                }
            });
            $(".variation-option-add-btn").click(function () {
                var newOption = $(".variation-option-template").clone(true, true);
                newOption.removeClass("variation-option-template");
                newOption.show();


                var variationParentDiv = $(this).parents().eq(2);
                variationParentDiv.find("ul").first().append(newOption);

                var count = $(this).parents().eq(2).find("ul").children().length + 1;
                if (count == 3) {
                    $(this).parents().eq(2).find("ul").children().first().find(".variation-option-delete-btn").show();
                }
                if (count == 21) {
                    $(this).hide();
                }
                $(this).find(".variation-option-add-btn-text").html("  Add Options (" + count + "/20)");



                var variation1count = $(".variation1-card").find("li").length;
                var variation2count = $(".variation2-section").find("li").length;


                if (variation2count * (variation1count + 1) > 50) {
                    $(".variation1-card").find(".variation-option-add-btn").prop("disable", true);
                    $(".variation1-card").find(".variation-option-add-btn").addClass("add-variation-disabled");
                    $(".variation1-card").find(".variation-option-add-btn").prop("disabled", true);
                }
                if ((variation2count + 1) * variation1count > 50) {
                    $(".variation2-section").find(".variation-option-add-btn").prop("disable", true);
                    $(".variation2-section").find(".variation-option-add-btn").addClass("add-variation-disabled");
                    $(".variation2-section").find(".variation-option-add-btn").prop("disabled", true);

                }

                //Adding the new option to the table
                if ($(this).attr("variation-number") == "1") {
                    var newAddedTableRow = $(".variation-table").children().last().clone(true, true);
                    newAddedTableRow.children().first().html("Option");
                    newAddedTableRow.find("input").each(function () {
                        if ($(this).hasClass("variation-stock-input")) {
                            $(this).val("0")
                        } else if ($(this).hasClass("variation-discounted-price-checkbox")) {
                            $(this).prop("checked", false);
                        } else {
                            $(this).val("");
                            if ($(this).hasClass("variation-discounted-price-input")) {
                                $(this).prop("disabled", true);
                            }
                        }
                    });
                    $(".variation-table").append(newAddedTableRow);
                    renameIsDiscountedEnabledCheckBoxes();
                }
                else {
                    var newAddedVariation2Row = $(".variation-table").children().find(".variation2-group").children().last().clone(true, true);
                    newAddedVariation2Row.children().first().html("Option");
                    newAddedVariation2Row.find("input").each(function () {
                        if ($(this).hasClass("variation-stock-input")) {
                            $(this).val("0")
                        } else if ($(this).hasClass("variation-discounted-price-checkbox")) {
                            $(this).prop("checked", false);
                        } else {
                            $(this).val("");
                            if ($(this).hasClass("variation-discounted-price-input")) {
                                $(this).prop("disabled", true);
                            }
                        }
                    });
                    $(".variation-table").find(".variation2-group").each(function () {
                        $(this).append(newAddedVariation2Row.clone(true, true));
                    });
                    renameIsDiscountedEnabledCheckBoxes();
                }
                updateVariationOneImagesTextLabel();
            });

            $(".variation-option-delete-btn").click(function () {
                // Remove the row of that variation from variation table

                var orderNumber = $(this).parent().parent().prevAll().length + 1;
                if ($(this).parents().eq(3).hasClass("variation1-card")) {
                    $(".variation-table").children().eq(orderNumber).remove();
                    if ($("#variationimageGallery").children().eq(orderNumber - 1).find(".remove-variation-img").length)
                        $("#variationimageGallery").children().eq(orderNumber - 1).find(".remove-variation-img").click();
                    else
                        $("#variationimageGallery").children().eq(orderNumber - 1).find(".remove-variation-img-url").click();
                }
                else {

                    $(".variation-table").find(".variation2-group").each(function () {
                        $(this).children().eq(orderNumber - 1).remove();
                    });

                }

                var cardElement = $(this).parents().eq(4);
                $(this).parent().parent().remove();
                var count = cardElement.find("li").length + 1;
                if (count == 2) {
                    cardElement.find("li").first().find(".variation-option-delete-btn").hide();
                }
                if (count == 20) {
                    cardElement.find(".variation-option-add-btn").show();
                }
                cardElement.find(".variation-option-add-btn-text").html("  Add Options (" + count + "/20)");
                unableAddingNewVariation();
                updateVariationOneImagesTextLabel();
            });

            getProductVariations(productId);
            getProductDemographicTargets(productId);

            //Shipping Cost
            $("#btnShippingCostModal").click(function () {
                $("#EditShippingCostModal").modal("show");
            });
            GetProvinceListForShippinCost(1);
        });

        function GetPostcodeList(districtId) {
            if (districtId == 0) {
                var options = "<option value=''>Choose Postcode</option>";
                $("#postCodeSelect").html();
                $("#postCodeSelect").html(options);
                $("#postCodeSelect").selectpicker('refresh');
                return;
            }
            $.ajax({
                type: "GET",
                async: false,
                dataType: 'json',
                url: '/Admin/Products/GetPostcodeList/' + districtId,
                success: function (response) {
                    var options = "<option value=''>Choose Postcode</option>";
                    $("#postCodeSelect").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            $("#postCodeSelect").html(options).selectpicker('refresh');
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }
        function GetDistrictList(provinceId) {
            if (provinceId == 0) {
                var options = "<option value=''>Choose District</option>";
                $("#distritSelect").html();
                $("#distritSelect").html(options);
                $("#distritSelect").selectpicker('refresh');;
                return;
            }

            $.ajax({
                type: "GET",
                async: false,
                dataType: 'json',
                url: '/Admin/Products/GetDistrictList/' + provinceId,
                success: function (response) {
                    var options = "<option value=''>Choose District</option>";
                    $("#distritSelect").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            $("#distritSelect").html(options).selectpicker('refresh');
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }
        function GetProvinceList(countryId) {
            if (countryId == 0) {
                var options = "<option value=''>Choose Province</option>";
                $("#provinceSelect").html();
                $("#provinceSelect").html(options);
                $("#provinceSelect").selectpicker('refresh');
                return;
            }
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProvinceList/' + countryId,
                success: function (response) {
                    var options = "<option value=''>Choose Province</option>";
                    $("#provinceSelect").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            $("#provinceSelect").html(options).selectpicker('refresh');;
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }
        function GetCountryList() {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetCountryList',
                success: function (response) {
                    var options = "<option value=''>Choose Country</option>";
                    $("#countrySelect").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            $("#countrySelect").html(options).selectpicker('refresh');;
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetProductLuckyDraw(productId) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProductLuckyDraw/' + productId,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            $("#EditWinningTicketId").val(response.data.winningTicketId);
                            $("#EditLuckyDrawTicketIssuesed").val(response.data.luckyDrawTicketIssued);
                            $("#EditLuckyDrawDate").val(moment(response.data.luckyDrawDate).format("YYYY-MM-DD"));
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetProductPendingChanges(productId) {
            $.ajax({
                type: "GET",
                async: false,
                dataType: 'json',
                url: '/Admin/Products/GetProductPendingChanges/' + productId,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            $("#productReviewRemarks").html(response.data.remarks);

                            $('#reviewDealType').val(response.data.dealType);

                            $('#reviewTitle').val(response.data.title);
                            $('#reviewSubtitle').val(response.data.subtitle);
                            $('#reviewCategory').val(response.data.productCategory);
                            $('#reviewSubcategory').val(response.data.productSubCategory);
                            $('#reviewDescription').val(response.data.description);
                            reviewDescription.root.innerHTML = response.data.description;
                            $('#reviewAdditionInfo').val(response.data.additionInfo);
                            reviewAdditionInfo.root.innerHTML = response.data.additionInfo;
                            $('#reviewFinePrint').val(response.data.finePrintInfo);
                            reviewFinePrint.root.innerHTML = response.data.finePrintInfo;
                            $('#reviewRedemptionInfo').val(response.data.redemptionInfo);
                            reviewRedemptionInfo.root.innerHTML = response.data.redemptionInfo;

                            if (response.data.dealTypeId == 0) {
                                $('#reviewPriceTypeDiv').hide();
                                $('#reviewPointTypeDiv').hide();
                            }
                            else if (response.data.dealTypeId == 1) {
                                $('#reviewPriceTypeDiv').hide();
                                $('#reviewPointTypeDiv').show();
                                $('#reviewPointRequired').val(response.data.pointsRequired);
                                $('#reviewActualproductPrice').val(response.data.actualPriceForVpoints);
                            }
                            else if (response.data.dealTypeId == 2) {
                                $('#reviewPriceTypeDiv').show();
                                $('#reviewPointTypeDiv').hide();
                                $('#reviewPrice').val(response.data.price);
                                $('#reviewDiscountedPrice').val(response.data.discountedPrice);
                                if (response.data.isDiscountedPriceEnabled) {
                                    $("#reviewIsDiscountedPriceEnabled").prop("checked", true);
                                } else {
                                    $("#reviewIsDiscountedPriceEnabled").prop("checked", false);
                                }
                            }
                            else if (response.data.dealTypeId == 3) {
                                $('#reviewPriceTypeDiv').hide();
                                $('#reviewPointTypeDiv').show();
                                $('#reviewPointRequired').val(response.data.pointsRequired);
                                $('#reviewActualproductPrice').val(response.data.actualPriceForVpoints);
                            }
                            else {
                                $('#reviewPriceTypeDiv').hide();
                                $('#reviewPointTypeDiv').hide();
                            }

                            $("#OutletModel_ReviewThirdPartyTypeId").val(response.data.thirdPartyTypeId);
                            $("#OutletModel_ReviewThirdPartyProductId").val(response.data.thirdPartyProductId);

                            if ($("#OutletModel_ReviewThirdPartyTypeId").val() == "") {
                                $("#reviewThirdpartyProductContainer").hide();
                            }
                            else {
                                $("#reviewThirdpartyProductContainer").show();
                            }


                            $('#reviewStartDate').val(moment(response.data.startDate).format("YYYY-MM-DD"));
                            $('#reviewEndDate').val(moment(response.data.endDate).format("YYYY-MM-DD"));

                            $('#reviewQuantity').val(response.data.availableQuantity);


                            if (response.data.isShareShippingDifferentItem) {
                                $('#reviewShareShippingDifferentItem').prop("checked",true)
                            }
                            $("#reviewShareShippingCostSameItem").val(response.data.shareShippingCostSameItem);
                            GetProductPendingChangesImages(productId);
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetMerchantOutletList(merchantId) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetMerchantOutletList/' + merchantId,
                success: function (response) {
                    var options = "";
                    $("#EditOutletList").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                var temp = "<span>" + options + "</span>";
                                var table = $(temp);
                                if (item.Province == undefined) {
                                    item.Province = "";
                                }
                                if ($("optgroup[label='" + item.Province + "']", table).length > 0) {
                                    var newoption = "<option value='" + item.id + "'>" + item.name + "</option>";
                                    $("optgroup[label='" + item.Province + "']", table).append(newoption);
                                    options = table.html();
                                }
                                else {
                                    options += "<optgroup label='" + item.Province + "'><option value='" + item.id + "'>" + item.name + "</option></optgroup>";
                                }
                            });
                            $("#EditOutletList").html(options);
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetProduct(productId) {
            $.ajax({
                type: "GET",
                async: false,
                dataType: 'json',
                url: '/Admin/Products/GetProduct/' + productId,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            console.log(response.data);
                            $("#AddOutletModal").attr("merchant-id", response.data.merchantId);
                            $("#productId").attr("image-url", response.data.imageFolderUrl);
                            $('#EditMerchantCode').val(response.data.merchantCode);
                            $('#EditMerchantName').val(response.data.merchantName);
                            $('#EditCommission').val(parseFloat(response.data.defaultCommission).toFixed(2));
                            $('#EditMerchantCode').attr("data-id", response.data.merchantId);
                            GetDealTypeList();
                            if (response.data.dealTypeId == null)
                                response.data.dealTypeId = 0;
                            $("#EditDealTypeList").val(response.data.dealTypeId);
                            $('#EditDealTypeList').change();
                            $('#EditTitle').val(response.data.title);
                            $('#EditSubtitle').val(response.data.subtitle);
                            GetProductCategoryList();
                            if (response.data.productCategoryId == null)
                                response.data.productCategoryId = 0;
                            $("#EditCategoryList").val(response.data.productCategoryId);
                            GetProductSubcategoryList(response.data.productCategoryId);
                            if (response.data.productSubCategoryId == null)
                                response.data.productSubCategoryId = 0;
                            $("#EditSubcategoryList").val(response.data.productSubCategoryId);
                            $("#EditDescription").val(response.data.description);
                            editDescription.root.innerHTML = response.data.description;
                            $("#EditAdditionInfo").val(response.data.additionInfo);
                            editAdditionInfo.root.innerHTML = response.data.additionInfo;
                            $("#EditFinePrint").val(response.data.finePrintInfo);
                            editFinePrint.root.innerHTML = response.data.finePrintInfo;
                            $("#EditRedemptionInfo").val(response.data.redemptionInfo);
                            editRedemptionInfo.root.innerHTML = response.data.redemptionInfo;
                            $("#EditPrice").val(response.data.price);
                            $("#EditDiscountedPrice").val(response.data.discountedPrice);
                            if (response.data.isDiscountedPriceEnabled) {
                                $("#IsDiscountedPriceEnabled").prop("checked", true);
                                $("#EditDiscountedPrice").prop("disabled", false);
                            } else {
                                $("#IsDiscountedPriceEnabled").prop("checked", false);
                                $("#EditDiscountedPrice").prop("disabled", true);
                            }
                            if (response.data.isShareShippingDifferentItem) {
                                $('#isShareShippingDifferentItem').prop("checked",true)
                            }
                            $("#shareShippingCostSameItem").val(response.data.shareShippingCostSameItem);

                            $("#IsDiscountedPriceEnabled").val(response.data.IsDiscountedPriceEnabled);
                            $("#EditPointRequired").val(response.data.pointsRequired);
                            $("#actualproductPrice").val(response.data.actualPriceForVpoints);
                            $("#actualproductPrice").val(response.data.actualPriceForVpoints);
                            $("#EditQuantity").val(response.data.availableQuantity);
                            $("#EditStartDate").val(moment(response.data.startDate).format("YYYY-MM-DD"));
                            $("#EditEndDate").val(moment(response.data.endDate).format("YYYY-MM-DD"));
                            $("#productStatus").html(response.data.statusType);
                            $("#productStatus").html($("#productStatus").html() + '<button type="button" class="btn btn-primary" style="margin-left:10px;" id="btnReview">Review</button>');
                            $('#btnReview').click(function () {
                                GetStatusTypeList();
                                GetProductPendingChanges($('#productId').attr("data-id"));
                                $("#productStatusList").val(4);
                                // $("#productStatusRemarks").val($("#ReviewProduct").attr("remarks"));
                                $('#ReviewProduct').modal("show");
                            });

                            $("#productStatus").attr("data-id", response.data.statusTypeId);
                            $("#ReviewProduct").attr("status-id", response.data.statusTypeId);
                            $("#ReviewProduct").attr("remarks", response.data.remarks);
                            $("#productRemarks").html(response.data.remarks);

                            $("#OutletModel_ThirdPartyTypeId").val(response.data.thirdPartyTypeId);
                            $("#OutletModel_ThirdPartyProductId").val(response.data.thirdPartyProductId);

                            $("#isProductVariationEnabled").prop("checked", false);
                            if (response.data.isProductVariationEnabled)
                                $("#isProductVariationEnabled").click();

                            if ($("#OutletModel_ThirdPartyTypeId").val() == "") {
                                $("#thirdpartyProductContainer").hide();
                            }
                            else {
                                $("#thirdpartyProductContainer").show();
                            }

                            if ($("#OutletModel_ReviewThirdPartyTypeId").val() == "") {
                                $("#reviewThirdpartyProductContainer").hide();
                            }
                            else {
                                $("#reviewThirdpartyProductContainer").show();
                            }

                            if (response.data.dealExpirationId != null) {
                                // $("#EditDealExpirationList").val(response.data.DealExpirationId);
                                GetProductDealExpiration(response.data.dealExpirationId);
                            }
                            else {
                                response.data.dealExpirationId = 0;
                                $("#EditDealExpirationList").val(response.data.dealExpirationId);
                                $('#EditDealExpirationList').change();
                            }
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetProductDiscount(Id) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProductDiscount/' + Id,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            $("#selectDiscountType").val(response.data.discountTypeId);
                            if (response.data.discountTypeId == 1) {
                                $("#EditDiscountValue").val(response.data.percentageValue);
                                $("#EditDiscountPoint").val(response.data.pointRequired);

                            }
                            else if (response.data.discountTypeId == 2) {
                                $("#EditDiscountValue").val(response.data.priceValue);
                                $("#EditDiscountPoint").val(response.data.pointRequired);

                            }
                            else{
                                $("#EditDiscountValue").val(response.data.priceValue);
                                $("#EditDiscountPoint").val(response.data.pointRequired);

                            }
                            //else if (response.data.discountTypeId == 4) {
                            //    $("#EditDiscountValue").val(response.data.percentageValue);
                            //    $("#EditDiscountPoint").val(response.data.priceValue);
                            //}
                            //else if (response.data.discountTypeId == 5) {
                            //    $("#EditDiscountValue").val(response.data.pointRequired);
                            //    $("#EditDiscountPoint").val(response.data.priceValue);

                            //}
                            var dealType = $('#EditDealTypeList').val();
                            if (dealType == 1) {
                                 //$('#EditProductPriceOrPoints').val($("#EditPointRequired").val() + " Points");
                                $('#EditProductPriceOrPoints').val("RM " + $("#actualproductPrice").val());
                            } else if (dealType == 2) {
                                $('#EditProductPriceOrPoints').val("RM " + $("#EditDiscountedPrice").val() + " RM");
                            }
                            else {
                                $('#EditProductPriceOrPoints').val("RM " + $("#EditDiscountedPrice").val() + " RM");
                            }

                            $("#EditDiscountStartDate").val(moment(response.data.startDate).format("YYYY-MM-DD"));
                            $("#EditDiscountEndDate").val(moment(response.data.endDate).format("YYYY-MM-DD"));
                            $("#selectDiscountType").change();

                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetProductDiscountList(productId) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProductDiscountList/' + productId,
                success: function (response) {
                    var options = "<option value='0'>Choose Product Discount</option>";
                    var options1 = "";
                    $("#selectCreatedDiscount").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $('#EditValidDiscountList').multiSelect('destroy');
                            $(response.data).each(function (index, item) {
                                options += "<option value='" + item.id + "'>" + item.name + "</option>";
                                if (item.isActivated)
                                    options1 += "<option value='" + item.id + "' selected>" + item.name + "</option>";
                                else
                                    options1 += "<option value='" + item.id + "'>" + item.name + "</option>";
                            });
                            $("#selectCreatedDiscount").html(options);
                            $("#EditValidDiscountList").html(options1);
                            $('#EditValidDiscountList').multiSelect({ selectableOptgroup: true });
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetDiscountTypeList(dealType) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetDiscountTypeList',
                success: function (response) {
                    var options = "<option value='0'>Choose Discount Type</option>";
                    $("#selectDiscountType").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                //if (dealType == 1 && (item.id == 1 || item.id == 2)) {
                                //    return true
                                //}
                                //if (dealType == 2 && (item.id != 1 && item.id != 2)) {
                                //    return true
                                //}
                                // if (item.id != 1 && item.id != 2) {
                                //    return true
                                //}
                                if (item.isActivated == false ) {
                                    return true
                                }
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            $("#selectDiscountType").html(options);
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetDealTypeList() {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetDealTypeList',
                success: function (response) {
                    var options = "<option value='0'>Choose Deal Type</option>";
                    $("#EditDealTypeList").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                //if (item.id == 1) {
                                //    return true;
                                //}
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            $("#EditDealTypeList").html(options);
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }
        function GetProductCategoryList() {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProductCategoryList',
                success: function (response) {
                    var options = "<option value='0'>Choose Product Category</option>";
                    $("#EditCategoryList").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            $("#EditCategoryList").html(options);
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }
        function GetProductSubcategoryList(categoryId) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProductSubCategoryList/' + categoryId,
                success: function (response) {
                    var options = "<option value='0'>Choose Product Subcategory</option>";
                    $("#EditSubcategoryList").html();
                    if (categoryId == 0) {
                        $("#EditSubcategoryList").html(options);
                        return;
                    }
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            $("#EditSubcategoryList").html(options);
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }
        function GetProductOutlets(productId) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProductOutletList/' + productId,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                $("#EditOutletList option[value='" + item.id + "']").attr("selected", "selected");
                            });
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }
        function GetStatusTypeList() {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetStatusTypeList',
                success: function (response) {
                    var options = "<option value='0'>Choose Status</option>";
                    $("#productStatusList").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                // Remove pending review option
                                if (index == 1)
                                    return true;
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            $("#productStatusList").html(options);
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetProductDealExpiration(dealExpirationId) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProductDealExpiration/' + dealExpirationId,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            $("#EditDealExpirationList").val(response.data.expirationTypeId);
                            if (response.data.expirationTypeId == 1) {
                                $("#EditRedemptionDays").val(response.data.totalValidDays);
                                $("#EditDealExpirationList").change();
                            }
                            else if (response.data.expirationTypeId == 2) {
                                $("#EditRedemptionStartDate").val(moment(response.data.startDate).format("YYYY-MM-DD"));
                                $("#EditRedemptionEndtDate").val(moment(response.data.expiredDate).format("YYYY-MM-DD"));
                                $("#EditDealExpirationList").change();
                            }
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetExpirationTypeList() {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetExpirationTypeList',
                success: function (response) {
                    var options = "<option value='0'>Choose a Product Type</option>";
                    $("#EditDealExpirationList").html();
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                options += "<option value=" + item.id + ">" + item.name + " - " + item.description + "</option>";
                            });
                            $("#EditDealExpirationList").html(options);
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function UpdateProductStatus(productId, statusId, remarks) {
            $.ajax({
                type: "POST",
                dataType: 'json',
                data: {
                    ProductId: productId, StatusTypeId: statusId, Remarks: remarks
                },
                url: '/Admin/Products/UpdateProductStatus',
                success: function (response) {
                    if (response.successful) {
                        toastr.success(response.message);
                        $("#productStatus").html($("#productStatusList option:selected").html());
                        $("#productStatus").attr("data-id", statusId);
                        $("#productRemarks").html(response.data);

                        $("#ReviewProduct").attr("status-id", statusId);
                        $("#ReviewProduct").attr("remarks", response.data);
                        UpdateBadge();
                        $('#ReviewProduct').modal("hide");
                    }
                    else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function UpdateProductDealExpiration(productId, expirationTypeId, startDate, expiredDate, totalValidDays) {
            $.ajax({
                type: "POST",
                dataType: 'json',
                data: {
                    ProductId: productId, ExpirationTypeId: expirationTypeId, StartDate: startDate, ExpiredDate: expiredDate, TotalValidDays: totalValidDays
                },
                url: '/Admin/Products/UpdateProductDealExpiration',
                success: function (response) {
                    if (response.successful) {
                        toastr.success(response.message);
                        //$("#productStatus").html($("#productStatusList option:selected").html());
                        //$("#productStatus").attr("data-id", statusId);

                        //$("#ReviewProduct").attr("status-id", statusId);
                        //$("#ReviewProduct").attr("remarks", remarks);
                        //UpdateBadge();
                        //$('#ReviewProduct').modal("hide");
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function UpdateBadge() {
            $("#productStatusBadge").removeClass();
            $("#productStatusBadge").addClass(GetBadgeClassName($("#productStatus").attr("data-id")));
        }

        function GetBadgeClassName(type) {
            if (type == 1) {
                return "alert alert-secondary";
            }
            if (type == 2) {
                return "alert alert-warning";
            }
            if (type == 3) {
                return "alert alert-pending-revision";
            }
            if (type == 4) {
                return "alert alert-success";
            }
            return "alert alert-danger";
        }

        function DeleteProductImages(productId) {
            $.ajax({
                url: "/Admin/Products/DeleteProductImages/" + productId,
                data: { removeFiles: removefilesList },
                type: "POST",
                async: false,
                dataType: 'json',
            }).done(function (response) {
                if (response.successful) {
                    toastr.success(response.message);
                    removefilesList = [];
                    //imagefilesname = response.data;
                }
                else
                    toastr.error(response.message);
            });

        }

        function GetProductImages(productId) {
            $.ajax({
                type: "GET",
                async: false,
                dataType: 'json',
                url: '/Admin/Products/GetProductImages/' + productId,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {

                            $(response.data).each(function (index, item) {
                                $($.parseHTML('<div class="product-img-preview-container" index="' + index + '" image-src="' + item + '"><img src="' + item + '" class="product-img-preview"/><span class="remove-img-url">Remove image</span></div>')).appendTo('#imageGallery');
                                SetRemoveImageUrlEvent();
                                fileList = [];
                                filesList.push(new File([""], item));
                            });
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetProductPendingChangesImages(productId) {
            $.ajax({
                type: "GET",
                async: false,
                dataType: 'json',
                url: '/Admin/Products/GetProductPendingChangesImages/' + productId,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            $("#reviewImageGallery").html("");
                            $(response.data).each(function (index, item) {
                                $($.parseHTML('<div class="product-img-preview-container" index="' + index + '" image-src="' + item + '"><img src="' + item + '" class="product-img-preview"/></div>')).appendTo('#reviewImageGallery');

                            });
                        }
                    }
                    else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        // #region quill editor
        var toolbarOptions = [
            ['bold', 'italic', 'underline'],
            [ 'link', 'image'],
            [{ 'list': 'ordered' }, { 'list': 'bullet' }],
            [{ 'script': 'sub' }, { 'script': 'super' }],
            ['clean']
        ];
        var editDescription = new Quill('#edit-description', {
            modules: {
                toolbar: toolbarOptions
            },
            placeholder: 'Compose an epic...',
            theme: 'snow'
        });

        var editRedemptionInfo = new Quill('#edit-redemption-info', {
            modules: {
                toolbar: toolbarOptions
            },
            placeholder: 'Compose an epic...',
            theme: 'snow'
        });

        var editAdditionInfo = new Quill('#edit-addition-Info', {
            modules: {
                toolbar: toolbarOptions
            },
            placeholder: 'Compose an epic...',
            theme: 'snow'
        });

        var editFinePrint = new Quill('#edit-fine-print', {
            modules: {
                toolbar: toolbarOptions
            },
            placeholder: 'Compose an epic...',
            theme: 'snow'
        });

        //review quill editors

        var reviewDescription = new Quill('#review-description', {
            modules: {
                toolbar: [
                ]
            },
            readOnly: true,
            theme: 'snow'
        });

        var reviewRedemptionInfo = new Quill('#review-redemption-info', {
            modules: {
                toolbar: [
                ]
            },
            readOnly: true,
            theme: 'snow'
        });

        var reviewAdditionInfo = new Quill('#review-addition-Info', {
            modules: {
                toolbar: [
                ]
            },
            readOnly: true,
            theme: 'snow'
        });

        var reviewFinePrint = new Quill('#review-fine-print', {
            modules: {
                toolbar: [
                ]
            },
            readOnly: true,
            theme: 'snow'
        });

        // #endregion

        function defineQuillEditors() {
            editDescription = new Quill('#edit-description', {
                modules: {
                    toolbar: toolbarOptions
                },
                placeholder: 'Compose an epic...',
                theme: 'snow'
            });

            editRedemptionInfo = new Quill('#edit-redemption-info', {
                modules: {
                    toolbar: toolbarOptions
                },
                placeholder: 'Compose an epic...',
                theme: 'snow'
            });

            editAdditionInfo = new Quill('#edit-addition-Info', {
                modules: {
                    toolbar: toolbarOptions
                },
                placeholder: 'Compose an epic...',
                theme: 'snow'
            });

            editFinePrint = new Quill('#edit-fine-print', {
                modules: {
                    toolbar: toolbarOptions
                },
                placeholder: 'Compose an epic...',
                theme: 'snow'
            });
        }

        //variation functions


        function renameIsDiscountedEnabledCheckBoxes() {
            $(".variation-table").find(".variation-discounted-price-checkbox").each(function (index) {

                $(this).attr("id", "isDiscountedPriceEnabled" + index);
                $(this).attr("name", "isDiscountedPriceEnabled" + index);
                $(this).parent().find("label").attr("for", "isDiscountedPriceEnabled" + index);

            });
        }

        function DeleteProductVariationImages(productId) {
            $.ajax({
                url: "/Admin/Products/DeleteProductVariationImages/" + productId,
                data: { removeFiles: removeVariationImagesList },
                type: "POST",
                async: false,
                dataType: 'json',
            }).done(function (response) {
                if (response.successful) {
                    toastr.success(response.message);
                    removefilesList = [];
                }
                else
                    toastr.error(response.message);
            });

        }

        function getProductVariationImages(productId) {
            $.ajax({
                type: "GET",
                async: false,
                dataType: 'json',
                url: '/Admin/Products/GetProductVariationImages/' + productId,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            $('#variationimageGallery').html("");
                            variationImagesList = [];
                            $(response.data).each(function (index, item) {
                                $($.parseHTML('<div class="product-variation-img-preview-container" index="' + index + '" variationName= "' + $($(".variation1-card").find("input")[index + 1]).val() + '" image-src="' + item + '"><img src="' + item + '" name="' + item + '" class="product-img-preview"/><span class="remove-variation-img-url">Remove image</span><span class="variation-image-name">' + $($(".variation1-card").find("input")[index + 1]).val() + '</span></div>')).appendTo('#variationimageGallery');
                                setRemoveVariationImageUrlEvent();
                                variationImagesList.push(new File([""], item));
                            });
                            updateVariationOneImagesTextLabel();
                        }
                    }
                }
            });
        }

        function setRemoveVariationImageEvent() {
            $(".remove-variation-img").unbind().click(function () {
                var index = $(this).parent(".product-variation-img-preview-container").attr("index");
                // var uploadedImages = 0;
                //  $("#imageGallery > span").each(function () {
                //     if ($(this).attr("image-src") != undefined) {
                //          uploadedImages++
                //     }
                //  });
                $(this).parent(".product-variation-img-preview-container").remove();
                variationImagesList.splice(index, 1);

                var index = 0;
                $(".variation-gallery").find(".product-variation-img-preview-container").each(function () {
                    $(this).attr("index", index++);
                });
                $('#EditVariationImage')[0].value = "";
                //sortVariationImages();
                updateVariationOneImagesTextLabel();
                sortVariationImagesFiles();
            });
        }

        function setRemoveVariationImageUrlEvent() {
            $(".remove-variation-img-url").unbind().click(function () {
                var imagesrc = $(this).parent(".product-variation-img-preview-container").attr("image-src");
                $(this).parent(".product-variation-img-preview-container").remove();
                var index = $(this).parent(".product-variation-img-preview-container").attr("index");
                variationImagesList.splice(index, 1);
                removeVariationImagesList.push(imagesrc);

                var index = 0;
                $(".variation-gallery").find(".product-variation-img-preview-container").each(function () {
                    $(this).attr("index", index++);
                });
                $('#EditVariationImage')[0].value = "";
                //sortVariationImages();
                updateVariationOneImagesTextLabel();
                sortVariationImagesFiles();
            });
        }

        function getProductVariations(productId) {
            $.ajax({
                type: "GET",
                async: false,
                dataType: 'json',
                url: '/Admin/Products/GetProductVariation/' + productId,
                success: function (response) {
                    if (response.successful) {
                        renderProductVariationsInView(response.data);

                        if (response.data != null) {

                            getProductVariationImages(productId);
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function renderProductVariationsInView(variationModel) {
            $(variationModel.variationList).each(function () {
                if (this.isFirstVariation) {
                    $(".variation1-card").find(".variation-name-input").val(this.name).attr("id", this.id).keyup();
                    $(this.variationOptions).each(function (index) {
                        if (index == 0) {
                            $(".variation1-card").find(".variation-option-input").first().val(this.name).keyup();
                            $(".variation1-card").find(".variation-option-input").first().attr("order", this.order).attr("id", this.id);
                        }
                        else {
                            $(".variation1-card").find(".variation-option-add-btn").click();
                            $(".variation1-card").find(".variation-option-input").eq(index).val(this.name).keyup();
                            $(".variation1-card").find(".variation-option-input").eq(index).attr("order", this.order).attr("id", this.id);
                        }
                    });
                }
                else {
                    $(".variation2-add-btn").click();
                    $(".variation2-section").find(".variation-name-input").val(this.name).attr("id", this.id).keyup();
                    $(this.variationOptions).each(function (index) {
                        if (index == 0) {
                            $(".variation2-section").find(".variation-option-input").first().val(this.name).keyup();
                            $(".variation2-section").find(".variation-option-input").first().attr("order", this.order).attr("id", this.id);
                        }
                        else {
                            $(".variation2-section").find(".variation-option-add-btn").click();
                            $(".variation2-section").find(".variation-option-input").eq(index).val(this.name).keyup();
                            $(".variation2-section").find(".variation-option-input").eq(index).attr("order", this.order).attr("id", this.id);
                        }
                    });
                }
            });

            $(variationModel.productVariationDetailsList).each(function (index) {
                $(".variation-table").find(".product-variation-details-row").eq(index).attr("id", this.id);
                $(".variation-table").find(".variation-price-input").eq(index).val(this.price);
                if (this.isDiscountedPriceEnabled)
                    $(".variation-table").find("#isDiscountedPriceEnabled" + index).click();
                $(".variation-table").find(".variation-discounted-price-input").eq(index).val(this.discountedPrice);
                $(".variation-table").find(".variation-stock-input").eq(index).val(this.availableQuantity);
                $(".variation-table").find(".variation-sku-input").eq(index).val(this.sku);

            });
        }

        function isInformationValid() {
            var isValid = true;
            $(".variation1-card").find("input").each(function () {
                if ($(this).val() == "") {
                    isValid = false;
                    toastr.error("Please fill in all the variation information");
                    $(this).focus();
                    return false;
                }
            });
            if (!isValid)
                return isValid
            if (!$(".variation2-add-btn").is(":visible")) {
                $(".variation2-section").find("input").each(function () {
                    if ($(this).val() == "") {
                        isValid = false;
                        toastr.error("Please fill in all the variation information");
                        $(this).focus();
                        return false;
                    }
                });
                if (!isValid)
                    return isValid
            }
            var isDiscountedEnabled = true;
            var price = 0;
            $(".variation-table").find("input").each(function () {
                if ($(this).hasClass("variation-discounted-price-checkbox") && !$(this).prop("checked")) {
                    isDiscountedEnabled = false;
                    return true;
                }
                if ($(this).val() == "" && isDiscountedEnabled) {
                    isValid = false;
                    toastr.error("Please fill in all the variation information");
                    $(this).focus();
                    return false;
                }
                if ($(this).hasClass("variation-price-input")) {
                    price = $(this).val();
                }
                if ($(this).hasClass("variation-discounted-price-input") && isDiscountedEnabled) {
                    if (parseFloat($(this).val()) >= parseFloat(price)) {
                        isValid = false;
                        toastr.error("Discounted price must be lower than the price");
                        $(this).focus();
                        return false;
                    }
                }

                isDiscountedEnabled = true
            });
            return isValid;
        }

        function updateVariationOneImagesTextLabel() {

            var variationImagesList = [];
            $("#variationimageGallery").children().each(function () {
                variationImagesList.push($(this).attr("variationname"));
            });
            var variationImagesCount = $("#variationimageGallery").children().length;
            var textRequired = false;
            var nextImageText = "";
            $(".variation1-card").find(".variation-option-input").each(function (index) {

                if ($("#variationimageGallery").children().eq(index).attr("variationname") != $(this).val()) {
                    if (nextImageText == "") {
                        nextImageText += $(this).val();
                        textRequired = true;
                        return false;
                    }
                    else
                        nextImageText += ", " + $(this).val();
                }
            });
            if (nextImageText != "")
                $(".variation-images-text").html("[Upload image (" + nextImageText + ")]");
            else if (textRequired)
                $(".variation-images-text").html("[Upload image (Option)]");
            else
                $(".variation-images-text").html("Upload image");

        }

        function getUnattachedVariationImagesIndexes() {
            unattachedVariationImagesIndexes = [];
            $(".variation1-card").find(".variation-option-input").each(function (index) {
                if ($("#variationimageGallery").children().eq(index).attr("variationname") != $(this).val() && $(".product-variation-img-preview-container[variationname='" + $(this).val() + "']").length == 0) {
                    unattachedVariationImagesIndexes.push(index + 1);
                }

            });
        }

        function sortVariationImagesBasedOnTheOptionsOrder() {
            $(".variation1-card").find(".variation-option-input").each(function (index) {
                if ($(".product-variation-img-preview-container[variationname='" + $(this).val() + "']").length > 0) {
                    $("#variationimageGallery").append($(".product-variation-img-preview-container[variationname='" + $(this).val() + "']"));
                }

            });
            sortVariationImagesFiles();
        }

        function sortVariationImagesFiles() {
            $("#variationimageGallery").find("img").each(function (index) {
                name = $(this).attr("name");
                $(variationImagesList).each(function (imagesIndex) {
                    if (this.name == name) {
                        tempFile = variationImagesList[index];
                        variationImagesList[index] = variationImagesList[imagesIndex];
                        variationImagesList[imagesIndex] = tempFile;
                    }
                });
            });
        }

        function unableAddingNewVariation() {
            if ($(".variation1-card").find(".variation-option-add-btn").prop("disabled") || $(".variation2-section").find(".variation-option-add-btn").prop("disabled")) {
                var variation1count = $(".variation1-card").find("li").length;
                var variation2count = $(".variation2-section").find("li").length;

                if (variation2count * (variation1count + 1) <= 50) {
                    $(".variation1-card").find(".variation-option-add-btn").prop("disable", false);
                    $(".variation1-card").find(".variation-option-add-btn").removeClass("add-variation-disabled");
                    $(".variation1-card").find(".variation-option-add-btn").prop("disabled", false);

                }
                if ((variation2count + 1) * variation1count <= 50) {
                    $(".variation2-section").find(".variation-option-add-btn").prop("disable", false);
                    $(".variation2-section").find(".variation-option-add-btn").removeClass("add-variation-disabled");
                    $(".variation2-section").find(".variation-option-add-btn").prop("disabled", false);

                }
            }

        }

        function sortVariationImages() {
            var index = 0;
            $(".product-variation-img-preview-container").each(function () {
                $(this).attr("variationName", $($(".variation1-card").find("input")[index + 1]).val());
                var variationOneTextForImage = $($(".variation1-card").find("input")[index + 1]).val() == "" ? "Option" : $($(".variation1-card").find("input")[index + 1]).val();
                $(this).find(".variation-image-name").html(variationOneTextForImage);
                $(this).attr("index", index);
                index++;
            });
        }


        function getProductDemographicTargets(productId) {
            $.ajax({
                type: "GET",
                async: false,
                dataType: 'json',
                url: '/Admin/Products/GetProductDemographicsTarget/' + productId,
                success: function (response) {
                    if (response.successful) {
                        if (response.data != null) {
                            console.log(response.data);
                            var demographicsHtml = "";

                            $(response.data.productDemographicsList).each(function () {
                                demographicsHtml += '<div class="col-xl-3 col-lg-4 col-md-6 col-12 mt-0 py-2"><div class="panel panel-default"><div class="panel-heading pb-0"><label>'
                                    + this.name + '</label></div><div class="panel-body" style=""><div class="row"><div class="col-lg-12 px-0 checkbox-item"><input class="vodus-input selectAllDemographicSelector" target-id="'
                                    + this.name + 'Items" data-val="true" type="checkbox" value="true"><label>All</label></div></div><div class="row demographics-target-parent" id="'
                                    + this.name + 'Items">';
                                var demographicName = this.name;
                                var demographicId = this.id;
                                var counter = 0;
                                $(this.demographicsValues).each(function () {
                                    demographicsHtml += '<div class="col-lg-12 checkBoxDataItem checkbox-item"> <input class="vodus-input demographicItem" id = "TargetPanel_'
                                        + this.name + '_' + counter + '" data-id="' + this.id + '" demographic-id="' + demographicId
                                        + '"  type = "checkbox"><label for="TargetPanel_'
                                        + this.name.replace(" ", "") + '_' + counter + '">' + this.name + '</label></div>';
                                });
                                demographicsHtml += '</div></div></div></div>';
                            });

                            $("#demo-target-container").append(demographicsHtml);
                            if (response.data.productDemographicTargets.length > 0) {
                                $(".selectAllDemographicSelector").prop("checked", false);
                                $(".demographicItem").prop("checked", false);
                            }
                            $(response.data.productDemographicTargets).each(function () {
                                $(".demographicItem[demographic-id='" + this.demographicTypeId + "'][data-id='" + this.demographicValue + "']").prop("checked", true);
                            });

                            $('.panel-body').each(function () {
                                var demoTargetParent = $(this).find('.demographics-target-parent');
                                if (demoTargetParent.find('input:checked').length == demoTargetParent.find('input').length) {
                                    $(this).find('.selectAllDemographicSelector').prop("checked", true);
                                }
                            })

                            demographicsTargetBindEvents();
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        $(document).ready(function () {
            $('.demographics-target-parent').each(function () {
                if ($(this).find('.vodus-input:checked').length == $(this).find('.vodus-input').length) {
                    $(this).closest('.panel-body').find('.selectAllDemographicSelector').prop("checked", true);
                } else if ($(this).find('.vodus-input:checked').length == 0) {
                    $(this).closest('.panel-body').find('.selectAllDemographicSelector').click();
                }
            })

            $('.demographics-target-parent .vodus-input').click(function () {
                var demoTargetParent = $(this).closest('.demographics-target-parent');
                if (demoTargetParent.find('.vodus-input:checked').length == demoTargetParent.find('.vodus-input').length) {
                    $(this).closest('.panel-body').find('.selectAllDemographicSelector').prop("checked", true);
                } else if (demoTargetParent.find('.vodus-input:checked').length == 0) {
                    $(this).closest('.panel-body').find('.selectAllDemographicSelector').prop("checked", false);
                }
            });

            $("#btnUpdateDemographicTargets").click(function () {
                var model = [];
                $(".demographics-target-parent").each(function () {
                    $(this).find(".demographicItem").each(function () {
                        if ($(this).prop("checked")) {
                            model.push({
                                DemographicValue: parseInt($(this).attr("data-id")),
                                DemographicTypeId: parseInt($(this).attr("demographic-id")),
                            });
                        }
                    });
                });

                $.ajax({
                    type: "POST",
                    data: JSON.stringify(model),
                    url: '/Admin/Products/UpdateProductDemographicsTargetCommand/' + $('#productId').attr("data-id"),
                    contentType: "application/json",
                    success: function (response) {
                        if (response.successful)
                            toastr.success(response.message);
                        else
                            toastr.error(response.message);
                    },
                    error: function (error) {
                        toastr.error(error);
                    }
                });
            });
        })

        function demographicsTargetBindEvents() {

            $(".selectAllDemographicSelector").each(function () {
                var demographicsParnetElement = $(this).attr("target-id");
                $(this).click(function () {
                    var isChecked = $(this).prop("checked");
                    $("#" + demographicsParnetElement).find(".demographicItem").each(function () {
                        $(this).prop("checked", isChecked);
                    });
                })
            });
        }

        //Shipping Cost
        function GetProvinceListForShippinCost(countryId) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProvinceList/' + countryId,
                success: function (response) {
                    var options = "";
                    if (response.successful) {
                        if (response.data != null) {
                            $(response.data).each(function (index, item) {
                                if (item.id == 15 || item.id == 16)
                                    return true;
                                options += '<div class="form-group row" ><div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12"><div><label for="" class="col-form-label mr-3">'
                                    + item.name + '</label><div class="shipping-price-div">' +
                                    '<div class="col row"><label for="" class="col-form-label">RM</label>'
                                    + '<input value="0.00" min="0" type="number" class="form-control ml-3 shipping-cost-input" province-id="'
                                    + item.id + '" /></div><div style="width:125px"></div></div></div></div></div>';
                            });
                            $("#divProvincesShippingCost").append(options);
                            GetShippingCostDetails($('#productId').attr("data-id"));
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

        function GetShippingCostDetails(productId) {
            $.ajax({
                type: "GET",
                dataType: 'json',
                async: false,
                url: '/Admin/Products/GetProductShippingCost/' + productId,
                success: function (response) {
                    var options = "<option value='0'>Choose Shipping Type</option>";
                    $("#ShippingCostType").html();
                    if (response.successful) {
                        if (response.data != null) {
                            console.log(response.data);
                            $(response.data.shippingTypes).each(function (index, item) {
                                options += "<option value=" + item.id + ">" + item.name + "</option>";
                            });
                            if (response.data.productShippingCost.shippingTypeId != 1) {
                                $(response.data.productShippingCost.shippingCosts).each(function (index, item) {
                                    $(".shipping-cost-input[province-id='" + item.provinceId + "']").val(item.cost.toFixed(2));
                                });
                            }

                            $("#ShippingCostType").html(options).selectpicker("refresh");
                            $("#ShippingCostType").change(function () {
                                if ($(this).val() == 3) {
                                    $(".conditional-shipping-type").show();
                                }
                                else {
                                    $(".conditional-shipping-type").hide();
                                }
                                if ($(this).val() == 1) {
                                    $("#divProvincesShippingCost").hide();
                                }
                                else {
                                    $("#divProvincesShippingCost").show();
                                }
                                $(".preview-shipping-type").html($("#ShippingCostType").find("option[value='" + $("#ShippingCostType").val() + "']").html());
                            });

                            $("#btnShippingCostApplyAll").click(function () {
                                var applyAllValue = $("#shippingCostApplyAll").val();
                                $(".shipping-cost-input").val(applyAllValue);
                            });

                            $(".shipping-condi-cost-input").val(response.data.productShippingCost.conditionalShippingCost.toFixed(2));
                            if (response.data.productShippingCost.shippingTypeId != 0)
                                $("#ShippingCostType").val(response.data.productShippingCost.shippingTypeId).selectpicker("refresh");
                            else
                                $("#ShippingCostType").val(1).selectpicker("refresh");
                            $("#ShippingCostType").change();

                            $("#updateShippingDetails").click(function () {
                                var shippingCostObj = { ConditionalShippingCost: 0, Id: 0, ProductId: parseInt(productId), ShippingCosts: [], ShippingTypeId: 0 };

                                shippingCostObj.shippingTypeId = parseInt($("#ShippingCostType").val());
                                shippingCostObj.conditionalShippingCost = parseFloat($(".shipping-condi-cost-input").val());


                                $(".shipping-cost-input").each(function () {
                                    var shippingCost = { ProvinceId: parseInt($(this).attr("province-id")), Cost: parseFloat($(this).val()) };
                                    shippingCostObj.ShippingCosts.push(shippingCost);
                                });
                                $.ajax({
                                    type: "POST",
                                    data: JSON.stringify(shippingCostObj),
                                    url: '/Admin/Products/UpdateProductShippingCost',
                                    contentType: "application/json",
                                    success: function (response) {
                                        if (response.successful) {
                                            toastr.success(response.message);
                                            $("#EditShippingCostModal").modal("hide");
                                        }
                                        else
                                            toastr.error(response.message);
                                    },
                                    error: function (error) {
                                        toastr.error(error);
                                    }
                                });

                            });
                        }
                    } else
                        toastr.error(response.message);
                },
                error: function (error) {
                    toastr.error(error);
                }
            });
        }

    </script>

}



